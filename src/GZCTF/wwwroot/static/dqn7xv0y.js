/* The GZ::CTF Project @unknown
 * 
 * License   : GNU Affero General Public License v3.0 (Core)
 * License   : LicenseRef-GZCTF-Restricted (Restricted components)
 * Commit    : Unofficial build version
 * Build     : 2025-12-08T11:45:34.456Z
 * Copyright (C) 2022-2025 GZTimeWalker. All Rights Reserved.
 */
import"./lcut4z52.js";import"./cbxtepre.js";import{p as e,s as t,t as n}from"./isy1dskq.js";import"./cdbutviq.js";import"./kocdnk2i.js";import{t as r}from"./f25gev77.js";import{t as i}from"./glsbf5jj.js";import"./hrbt7ry7.js";import{c as a,i as o,l as s,u as c}from"./gaobt2im.js";import"./j0saofxo.js";import{t as l}from"./kpl3u1sg.js";import{t as u}from"./nugqs812.js";import"./gjb4rijj.js";import{t as d}from"./dut9ujr7.js";import"./b671iymd.js";import{t as f}from"./gmgm1gqp.js";import{t as p}from"./h0nb8b87.js";import{$n as m,An as h,Br as g,Bt as _,C as v,Ca as y,Dr as b,Hr as x,Jr as S,Li as C,Mi as w,Mr as T,Nr as E,O as D,Oa as O,Or as k,Qn as ee,Ri as A,Ti as j,Ur as M,Wi as N,Yn as P,_i as te,a as ne,cr as F,dr as I,h as re,ha as L,i as R,j as ie,jr as z,li as B,nr as V,vt as ae,w as oe,yi as se}from"./index.hrqptwjo.js";import"./iwhjrhtg.js";import"./mdazlrzp.js";import{t as ce}from"./c5hn22cb.js";import{t as H}from"./eojlsg3s.js";import"./fmw116au.js";import{t as U}from"./ekmrvexc.js";import{t as le}from"./efdmup3n.js";import"./laaps3um.js";import{t as ue}from"./odnwo8oc.js";var W=O(D()),G=O(b()),K=O(y()),q=O(L());const de=({data:e})=>{let t=C(),{colorScheme:n}=w(),r=n===`dark`?t.colors.light[1]:t.colors.dark[5],i=n===`dark`?t.colors.gray[6]:t.colors.light[1],a=(0,K.useMemo)(()=>{let[r,i]=n===`dark`?[3,7]:[4,8];return V.scale([t.colors[t.primaryColor][r],t.colors[t.primaryColor][i]]).mode(`oklch`).colors(e.length)},[e.length,t.primaryColor,t.colors,n]);return(0,q.jsx)(U,{option:(0,K.useMemo)(()=>({animation:!0,backgroundColor:`transparent`,color:a,tooltip:{trigger:`item`,formatter:`{b}: {c} ({d}%)`,borderWidth:0,textStyle:{fontSize:12,color:r},backgroundColor:i},legend:{orient:`horizontal`,left:`center`,top:`bottom`,data:e.map(e=>e.name),textStyle:{color:r,fontWeight:`bold`}},series:[{type:`pie`,radius:[`45%`,`65%`],center:[`50%`,`45%`],avoidLabelOverlap:!1,itemStyle:{borderRadius:8,borderWidth:0},label:{show:!1,position:`center`},emphasis:{label:{show:!0,fontSize:14,fontWeight:`bold`}},labelLine:{show:!1},data:e}]}),[e,a,r,i]),opts:{renderer:`svg`},style:{width:`100%`,height:`100%`,display:`flex`}})},fe=({indicator:e,value:t,name:n})=>{let r=C(),{colorScheme:i}=w();return(0,q.jsx)(U,{option:(0,K.useMemo)(()=>({animation:!0,color:r.colors[r.primaryColor][5],backgroundColor:`transparent`,radar:{indicator:e,shape:`circle`,radius:`75%`,center:[`50%`,`55%`],axisName:{color:i===`dark`?r.colors.light[1]:r.colors.dark[5],fontWeight:`bold`}},series:[{type:`radar`,data:[{value:t,name:n,areaStyle:{color:A(r.colors[r.primaryColor][4],.8)},lineStyle:{width:2},symbolSize:4}]}]}),[A,r,e,t,n]),opts:{renderer:`svg`},style:{width:`100%`,height:`100%`,display:`flex`}})};var J={header:`Yc`,titleBar:`Zc`,titleGroup:`_e`,avatar:`-e`,infoWrap:`ae`,nameRow:`be`,teamName:`ce`,divisionBadge:`de`,bioText:`ee`};function pe(e,t,n){let r=e&&Object.keys(e).map(t=>({name:t,scoreSum:e[t].reduce((e,t)=>e+(t.solved?t.score:0),0),max:1}));return{indicator:r,value:r?.map(e=>{let r=(n?.solvedChallenges?.filter(n=>t?.get(n.id)?.category===e.name))?.reduce((e,t)=>e+t.score,0)??0;return Math.min(r/e.scoreSum,1)}),name:n?.name??``}}function me(e){let t=e?.solvedChallenges?.reduce((e,t)=>{let n=e.get(t.userName)??0;return e.set(t.userName,n+t.score),e},new Map)??new Map,n=Array.from(t.entries()).map(([e,t])=>({name:e,value:t}));return n.sort((e,t)=>t.value-e.value),{data:n}}const he=e=>{let{item:t,scoreboard:n,bloodBonusMap:r,divisionMap:i,...a}=e,{t:o}=I(),{locale:s}=m(),c=n?.challenges,l=c&&Object.keys(c).reduce((e,t)=>(c[t].forEach(t=>{e.set(t.id,t)}),e),new Map),u=t&&c&&l,p=(t?.solvedCount??0)/(n?.challengeCount??1),h=(0,K.useMemo)(()=>u?pe(c,l,t):null,[u,c,l,t]),_=(0,K.useMemo)(()=>u?me(t):null,[u,t]);return(0,q.jsx)(E,{...a,classNames:{header:J.header,title:J.titleBar},title:(0,q.jsxs)(B,{justify:`left`,gap:`md`,wrap:`nowrap`,className:J.titleGroup,children:[(0,q.jsx)(M,{alt:`avatar`,src:t?.avatar,size:50,radius:`md`,className:J.avatar,children:t?.name?.slice(0,1)??`T`}),(0,q.jsxs)(z,{gap:0,className:J.infoWrap,children:[(0,q.jsxs)(B,{gap:4,wrap:`nowrap`,className:J.nameRow,children:[(0,q.jsx)(k,{order:4,lineClamp:1,className:J.teamName,title:t?.name??`Team`,children:t?.name??`Team`}),t?.divisionId&&(0,q.jsx)(x,{size:`sm`,variant:`outline`,className:J.divisionBadge,children:i.get(t.divisionId)??`Unknown`})]}),(0,q.jsx)(S,{size:`sm`,lineClamp:1,className:J.bioText,title:t?.bio||o(`team.placeholder.bio`),children:t?.bio||o(`team.placeholder.bio`)})]})]}),children:(0,q.jsxs)(z,{align:`center`,gap:`xs`,children:[(0,q.jsxs)(z,{w:`85%`,miw:`20rem`,children:[(0,q.jsx)(g,{h:`14rem`,children:u&&h&&_&&(0,q.jsxs)(B,{wrap:`nowrap`,gap:0,justify:`center`,w:`100%`,h:`100%`,children:[(0,q.jsx)(fe,{...h}),(0,q.jsx)(de,{..._})]})}),(0,q.jsxs)(B,{grow:!0,ta:`center`,children:[(0,q.jsxs)(z,{gap:2,children:[(0,q.jsx)(S,{fw:`bold`,size:`sm`,ff:`monospace`,children:t?.rank||`-`}),(0,q.jsx)(S,{size:`xs`,fw:500,children:o(`game.label.score_table.rank_total`)})]}),t?.divisionId&&(0,q.jsxs)(z,{gap:2,children:[(0,q.jsx)(S,{fw:`bold`,size:`sm`,ff:`monospace`,children:t?.divisionRank||`-`}),(0,q.jsx)(S,{size:`xs`,fw:500,children:o(`game.label.score_table.rank_division`)})]}),(0,q.jsxs)(z,{gap:2,children:[(0,q.jsx)(S,{fw:`bold`,size:`sm`,ff:`monospace`,children:t?.score}),(0,q.jsx)(S,{size:`xs`,fw:500,children:o(`game.label.score_table.score`)})]}),(0,q.jsxs)(z,{gap:2,children:[(0,q.jsx)(S,{fw:`bold`,size:`sm`,ff:`monospace`,children:t?.solvedCount}),(0,q.jsx)(S,{size:`xs`,fw:500,children:o(`game.label.score_table.solved_count`)})]})]}),(0,q.jsx)(d,{value:p*100})]}),t?.solvedCount&&t?.solvedCount>0?(0,q.jsx)(se,{scrollbarSize:6,h:`12rem`,w:`100%`,scrollbars:`y`,children:(0,q.jsxs)(f,{className:ce.table,children:[(0,q.jsx)(f.Thead,{children:(0,q.jsxs)(f.Tr,{children:[(0,q.jsx)(f.Th,{children:o(`common.label.user`)}),(0,q.jsx)(f.Th,{children:o(`common.label.challenge`)}),(0,q.jsx)(f.Th,{children:o(`game.label.score_table.type`)}),(0,q.jsx)(f.Th,{children:o(`game.label.score_table.score`)}),(0,q.jsx)(f.Th,{children:o(`common.label.time`)})]})}),(0,q.jsx)(f.Tbody,{children:t?.solvedChallenges&&l&&t.solvedChallenges.sort((e,t)=>(0,G.default)(t.time).diff((0,G.default)(e.time))).map(e=>{let t=l.get(e.id);return(0,q.jsxs)(f.Tr,{children:[(0,q.jsx)(f.Td,{fw:`bold`,children:e.userName}),(0,q.jsx)(f.Td,{children:(0,q.jsx)(H,{text:t.title,miw:`14rem`,maw:`20rem`})}),(0,q.jsx)(f.Td,{fz:`sm`,children:t.category}),(0,q.jsxs)(f.Td,{ff:`monospace`,fz:`sm`,children:[e.score,t.score&&e.score>t.score&&e.type&&ne.includes(e.type)&&(0,q.jsx)(S,{size:`sm`,c:`dimmed`,span:!0,children:`(${r.get(e.type)?.descr})`})]}),(0,q.jsx)(f.Td,{ff:`monospace`,fz:`sm`,children:(0,G.default)(e.time).locale(s).format(`SL HH:mm:ss`)})]},e.id)})})]})}):(0,q.jsx)(S,{py:`1rem`,fw:`bold`,children:o(`game.placeholder.no_solved`)})]})})};var Y={table:`cc`,thead:`dc`,left:`ec`,header:`fc`,mono:`gc`,teamCell:`hc`,legend:`ic`,text:`jc`,pointer:`kc`,wrapper:`lc`,input:`mc`},ge=O(b()),X=[60,60,175,60,70,60],Z=X.reduce((e,t)=>(e.push(e[e.length-1]+t),e),[0]),_e=K.memo(e=>{let t=C(),{colorScheme:n}=w(),{t:r}=I(),i=oe(),a=[...[,,,,,].keys()].map(e=>(0,q.jsx)(f.Th,{className:Y.left,style:{left:Z[e],width:X[e],minWidth:X[e],maxWidth:X[e]},children:`\xA0`},e));return(0,q.jsxs)(f.Thead,{className:Y.thead,children:[(0,q.jsxs)(f.Tr,{className:u.noBorder,children:[a,Object.keys(e).map(r=>{let a=i.get(r);return(0,q.jsx)(f.Th,{colSpan:e[r].length,h:`3rem`,style:{backgroundColor:A(t.colors[a.color][n===`dark`?8:6],n===`dark`?.15:.2)},children:(0,q.jsxs)(B,{gap:4,wrap:`nowrap`,justify:`center`,w:`100%`,children:[(0,q.jsx)(W.Icon,{path:a.icon,size:1,color:t.colors[a.color][n===`dark`?8:6]}),(0,q.jsx)(S,{c:a.color,className:Y.text,ff:`text`,fz:`sm`,children:r})]})},r)})]}),(0,q.jsxs)(f.Tr,{children:[a,Object.keys(e).map(t=>e[t].map(e=>(0,q.jsx)(f.Th,{children:e.title},e.id)))]}),(0,q.jsxs)(f.Tr,{children:[[r(`game.label.score_table.rank_total`),r(`game.label.score_table.rank_division`),r(`common.label.team`),r(`game.label.score_table.solved_count`),r(`game.label.score_table.score_total`)].map((e,t)=>(0,q.jsx)(f.Th,{className:N(Y.left,Y.header),style:{left:Z[t]},children:e},t)),Object.keys(e).map(t=>e[t].map(e=>(0,q.jsx)(f.Th,{className:Y.mono,children:e.score},e.id)))]})]})}),ve=K.memo(({item:e,challenges:t,onOpenDetail:n,iconMap:r,tableRank:i,allRank:a,divisionMap:o})=>{let s=oe(),c=e.solvedChallenges,l=C(),{colorScheme:u}=w(),{locale:d}=m(),p=e.divisionId!==void 0&&e.divisionId!==null?o.get(e.divisionId):void 0,h=(0,K.useMemo)(()=>{let e=r.get(P.Normal),t=u===`dark`?l.colors.gray[4]:l.colors.gray[6];return{path:ae,size:e?.size??1,color:t}},[r,l,u]),_=(0,K.useMemo)(()=>c?.reduce((e,t)=>e+(t?.score??0),0)??0,[c]);return(0,q.jsxs)(f.Tr,{children:[(0,q.jsx)(f.Td,{className:N(Y.mono,Y.left),style:{left:Z[0]},children:e.rank||`-`}),(0,q.jsx)(f.Td,{className:N(Y.mono,Y.left),style:{left:Z[1]},children:a?e.rank:e.divisionRank??i}),(0,q.jsx)(f.Td,{className:Y.left,style:{left:Z[2]},children:(0,q.jsxs)(B,{justify:`left`,gap:5,wrap:`nowrap`,onClick:n,maw:X[2]-10,className:Y.pointer,children:[(0,q.jsx)(M,{alt:`avatar`,src:e.avatar,radius:`xl`,size:30,color:l.primaryColor,children:e.name?.slice(0,1)??`T`}),(0,q.jsxs)(z,{gap:0,h:`2.5rem`,justify:`center`,w:X[2]-45,children:[(0,q.jsx)(H,{size:`sm`,text:e.name||``,onClick:n}),!!p&&(0,q.jsx)(S,{size:`xs`,c:`dimmed`,ta:`start`,truncate:!0,className:Y.text,children:p})]})]})}),(0,q.jsx)(f.Td,{className:N(Y.mono,Y.left),style:{left:Z[3]},children:c?.length}),(0,q.jsx)(f.Td,{className:N(Y.mono,Y.left),style:{left:Z[4]},children:_}),t&&Object.keys(t).map(e=>t[e].map(e=>{let t=c?.find(t=>t.id===e.id),n=t&&t.type===P.Normal&&(t.score??0)===0?h:r.get(t?.type??P.Unaccepted);if(!n)return(0,q.jsx)(f.Td,{className:Y.mono},e.id);let i=s.get(e.category);return(0,q.jsx)(f.Td,{className:Y.mono,children:(0,q.jsx)(T,{transitionProps:{transition:`pop`},label:(0,q.jsxs)(z,{align:`flex-start`,gap:0,maw:`20rem`,children:[(0,q.jsx)(S,{lineClamp:3,fz:`xs`,className:Y.text,children:e.title}),(0,q.jsxs)(S,{c:i.color,fz:`xs`,className:N(Y.text,Y.mono),children:[`+ `,t?.score,` pts`]}),(0,q.jsxs)(S,{c:`dimmed`,fz:`xs`,className:N(Y.text,Y.mono),children:[`# `,(0,ge.default)(t?.time).locale(d).format(`L LTS`)]})]}),children:(0,q.jsx)(g,{children:(0,q.jsx)(W.Icon,{...n})})})},e.id)}))]})}),Q=30;const ye=({divisionId:t,setDivisionId:n})=>{let{id:a}=F(),o=parseInt(a??`-1`),{iconMap:c}=re(1),[d,m]=(0,K.useState)(1),[h,g]=(0,K.useState)(R.default),[y,b]=(0,K.useState)(``),[x]=e(y,400),{scoreboard:C}=s(o),w=(0,K.useMemo)(()=>{let e=new Map;return C?.divisions?.forEach(t=>{e.set(t.id,t.name.trim())}),e},[C?.divisions]),E=(0,K.useMemo)(()=>(C?.divisions??[]).map(e=>({value:e.id.toString(),label:e.name.trim()})),[C?.divisions]),D=(0,K.useMemo)(()=>t===null?`all`:t.toString(),[t]);(0,K.useEffect)(()=>{t!==null&&!w.has(t)&&n(null)},[w,t,n]);let O=(0,K.useMemo)(()=>C?.items?x&&x.length>0?C.items.filter(e=>e.name?.toLowerCase().includes(x.toLowerCase())):t===null?C.items.filter(e=>e.rank>0):C.items.filter(e=>(e.divisionId??null)===t):[],[C,x,t]);(0,K.useEffect)(()=>{m(1),n(null),b(``)},[a,n]);let k=(d-1)*Q,ee=O?.slice(k,k+Q),[A,M]=(0,K.useState)(null),[N,P]=(0,K.useState)(!1),{t:L}=I();(0,K.useEffect)(()=>{C&&g(new R(C.bloodBonus))},[C]);let V=v(h),ae=E.length>0;return(0,q.jsxs)(te,{shadow:`md`,p:`md`,children:[(0,q.jsxs)(z,{gap:`xs`,children:[(0,q.jsxs)(l,{children:[(0,q.jsx)(l.Col,{span:3,children:(0,q.jsx)(i,{defaultValue:`all`,data:[{value:`all`,label:L(`game.label.score_table.all_teams`)},...E],value:D,readOnly:!ae,onChange:e=>{if(!e||e===`all`)n(null);else{let t=Number(e);n(Number.isNaN(t)?null:t)}m(1)},leftSection:(0,q.jsx)(W.Icon,{path:ie,size:1})})}),(0,q.jsx)(l.Col,{span:6}),(0,q.jsx)(l.Col,{span:3,children:(0,q.jsx)(p,{placeholder:L(`game.placeholder.search_team`),value:y,onChange:e=>b(e.currentTarget.value),leftSection:(0,q.jsx)(W.Icon,{path:_,size:1})})})]}),(0,q.jsxs)(j,{pos:`relative`,mih:`calc(100vh - 14rem)`,children:[(0,q.jsx)(f.ScrollContainer,{minWidth:`100%`,classNames:{scrollContainer:u.noScrollBars},children:(0,q.jsxs)(f,{className:Y.table,children:[(0,q.jsx)(_e,{...C?.challenges}),(0,q.jsx)(f.Tbody,{children:C&&ee?.map((e,n)=>(0,q.jsx)(ve,{allRank:t===null,tableRank:k+n+1,item:e,onOpenDetail:()=>{M(e),P(!0)},challenges:C.challenges,iconMap:c,divisionMap:w},k+n))})]})}),(0,q.jsx)(j,{className:Y.legend,children:(0,q.jsxs)(z,{gap:`xs`,children:[(0,q.jsx)(T.Group,{children:(0,q.jsx)(B,{gap:`lg`,children:ne.map((e,t)=>(0,q.jsx)(T,{label:V.get(e)?.name,transitionProps:{transition:`pop`},children:(0,q.jsxs)(B,{justify:`left`,gap:2,children:[(0,q.jsx)(W.Icon,{...c.get(e)}),(0,q.jsx)(S,{children:V.get(e)?.descr})]})},t))})}),(0,q.jsx)(S,{size:`sm`,c:`dimmed`,children:L(`game.content.scoreboard_note`)})]})})]}),(0,q.jsxs)(B,{justify:`space-between`,children:[(0,q.jsx)(S,{size:`sm`,c:`dimmed`,children:L(`game.content.scoreboard_tip`)}),(0,q.jsx)(r,{value:d,onChange:m,total:Math.ceil((O?.length??1)/Q),boundaries:2})]})]}),(0,q.jsx)(he,{scoreboard:C,divisionMap:w,bloodBonusMap:V,opened:N,withCloseButton:!1,size:`45rem`,onClose:()=>P(!1),item:A})]})};var $=O(b());const be=({divisionId:e})=>{let{id:t}=F(),n=parseInt(t??`-1`),r=C(),{scoreboard:i}=s(n),{game:c}=a(n),{startTime:l,endTime:u,progress:d,finished:f}=o(c),p=u.diff(l,`d`),h=p>14,g=d-7/p*100,_=d,v=h&&!f?g:0,y=h&&!f?_:100,{colorScheme:b}=w(),{t:x}=I(),{language:S}=m(),T=ee(S),E=(0,K.useMemo)(()=>{let e=new Map;return i?.timelines&&i.timelines.forEach(t=>{let n=t.divisionId??0;e.set(n,t.teams??[])}),e},[i?.timelines]),D=(0,K.useMemo)(()=>e===null?0:e,[e]),O=(0,K.useMemo)(()=>{if(E.size===0)return;let e=E.get(D);if(e)return e;let t=E.get(0);if(t)return t;let n=E.values().next();return n.done?void 0:n.value},[E,D]),k=(0,K.useMemo)(()=>{if(!O||!c)return[];let e=O,t=(0,$.default)(),n=u.diff(t,`s`)<0?u:t;return[{type:`line`,step:`end`,data:[],markLine:(0,$.default)(c.end).diff((0,$.default)(),`s`)<0?void 0:{symbol:`none`,data:[{xAxis:n.toDate(),lineStyle:{color:b===`dark`?r.colors.gray[3]:r.colors.gray[6],wight:2},label:{textBorderWidth:0,fontWeight:500,formatter:e=>(0,$.default)(e.value).format(`YYYY-MM-DD HH:mm`)}}]}},...e?.map(e=>({type:`line`,step:`end`,name:e.name,data:[[(0,$.default)(c.start).toDate(),0],...e.items?.map(e=>[e.time,e.score])??[],[n.toDate(),(e.items&&e.items[e.items.length-1]?.score)??0]]}))??[]]},[O,c,u,b,r]);return(0,q.jsx)(U,{option:{...(0,K.useMemo)(()=>{let e=b===`dark`,t=e?r.colors.light[1]:r.colors.dark[5],n=e?r.colors.gray[3]:r.colors.gray[6],i=e?r.colors.gray[6]:r.colors.light[1];return{animation:!0,backgroundColor:`transparent`,toolbox:{show:!0,feature:{dataZoom:{},restore:{},saveAsImage:{}}},xAxis:{type:`time`,min:(0,$.default)(c?.start).toDate(),max:(0,$.default)(c?.end).toDate(),splitLine:{show:!1}},yAxis:{type:`value`,name:x(`game.label.score`),nameTextStyle:{color:t,fontWeight:`normal`},boundaryGap:[0,`100%`],axisLabel:{formatter:x(`game.label.score_formatter`),color:t},max:e=>(Math.floor(e.max/1e3)+1)*1e3,splitLine:{show:!0,lineStyle:{color:[n],type:`dashed`}}},tooltip:{trigger:`axis`,borderWidth:0,textStyle:{fontSize:12,color:t},backgroundColor:i},legend:{orient:`horizontal`,top:420,textStyle:{fontSize:12,color:t}},grid:{top:50,left:70,right:40,bottom:110},dataZoom:[{type:`inside`,start:v,end:y,xAxisIndex:0,filterMode:`none`},{type:`slider`,start:v,end:y,xAxisIndex:0,showDetail:!1,bottom:60,height:20},{type:`inside`,start:0,end:100,yAxisIndex:0,filterMode:`none`},{type:`slider`,start:0,end:100,yAxisIndex:0,showDetail:!1,right:10,width:20}]}},[x,c?.start,c?.end,b,r,v,y]),series:k},opts:{renderer:`svg`,locale:T},style:{width:`100%`,height:`460px`,display:`flex`}})};var xe=O(b());const Se=K.memo(e=>{let{item:n,scoreboard:r,divisionMap:i,...a}=e,{t:o}=I(),{locale:s}=m(),c=r?.challenges,l=(0,K.useMemo)(()=>c?Object.keys(c).reduce((e,t)=>(c[t].forEach(t=>{e.set(t.id,t)}),e),new Map):new Map,[c]),u=(n?.solvedCount??0)/(r?.challengeCount??1),p=(0,K.useMemo)(()=>c?Object.keys(c).map(e=>({name:e,scoreSum:c[e].reduce((e,t)=>e+(t.solved?t.score:0),0),max:1})):[],[c]),h=(0,K.useMemo)(()=>!p||!n?.solvedChallenges?[]:p.map(e=>{let t=n.solvedChallenges.filter(t=>l.get(t.id)?.category===e.name).reduce((e,t)=>e+t.score,0);return Math.min(t/e.scoreSum,1)}),[p,n?.solvedChallenges,l]),_=(0,K.useMemo)(()=>n?.solvedChallenges?n.solvedChallenges.sort((e,t)=>(0,xe.default)(t.time).diff((0,xe.default)(e.time))):[],[n?.solvedChallenges]);return(0,q.jsx)(E,{...a,classNames:{header:J.header,title:J.titleBar},title:(0,q.jsxs)(B,{justify:`left`,gap:`md`,wrap:`nowrap`,w:`100%`,className:J.titleGroup,children:[(0,q.jsx)(M,{alt:`avatar`,src:n?.avatar,size:50,radius:`md`,className:J.avatar,children:n?.name?.slice(0,1)??`T`}),(0,q.jsxs)(z,{gap:0,className:J.infoWrap,children:[(0,q.jsxs)(B,{gap:4,wrap:`nowrap`,className:J.nameRow,children:[(0,q.jsx)(k,{order:4,lineClamp:1,className:J.teamName,title:n?.name??`Team`,children:n?.name??`Team`}),n?.divisionId&&(0,q.jsx)(x,{size:`sm`,variant:`outline`,className:J.divisionBadge,children:i.get(n.divisionId)??`Unknown`})]}),(0,q.jsx)(S,{size:`sm`,lineClamp:1,className:J.bioText,title:n?.bio||o(`team.placeholder.bio`),children:n?.bio||o(`team.placeholder.bio`)})]})]}),children:(0,q.jsxs)(z,{align:`center`,gap:`xs`,children:[(0,q.jsxs)(z,{w:`60%`,miw:`20rem`,children:[(0,q.jsxs)(g,{h:`14rem`,children:[(0,q.jsx)(t,{visible:!p||!h}),n&&p&&h&&(0,q.jsx)(fe,{indicator:p,value:h,name:n?.name??``})]}),(0,q.jsxs)(B,{grow:!0,ta:`center`,children:[(0,q.jsxs)(z,{gap:1,children:[(0,q.jsx)(S,{fw:`bold`,size:`sm`,ff:`monospace`,children:n?.rank||`-`}),(0,q.jsx)(S,{size:`xs`,children:o(`game.label.score_table.rank_total`)})]}),n?.divisionId&&(0,q.jsxs)(z,{gap:1,children:[(0,q.jsx)(S,{fw:`bold`,size:`sm`,ff:`monospace`,children:n?.divisionRank||`-`}),(0,q.jsx)(S,{size:`xs`,children:o(`game.label.score_table.rank_division`)})]}),(0,q.jsxs)(z,{gap:1,children:[(0,q.jsx)(S,{fw:`bold`,size:`sm`,ff:`monospace`,children:n?.score}),(0,q.jsx)(S,{size:`xs`,children:o(`game.label.score_table.score`)})]}),(0,q.jsxs)(z,{gap:1,children:[(0,q.jsx)(S,{fw:`bold`,size:`sm`,ff:`monospace`,children:n?.solvedCount}),(0,q.jsx)(S,{size:`xs`,children:o(`game.label.score_table.solved_count`)})]})]}),(0,q.jsx)(d,{value:u*100,size:`sm`})]}),n?.solvedCount&&n?.solvedCount>0?(0,q.jsx)(se,{scrollbarSize:6,h:`12rem`,w:`100%`,children:(0,q.jsxs)(f,{className:ce.table,fz:`sm`,children:[(0,q.jsx)(f.Thead,{children:(0,q.jsxs)(f.Tr,{children:[(0,q.jsx)(f.Th,{children:o(`common.label.challenge`)}),(0,q.jsx)(f.Th,{children:o(`game.label.score_table.score`)}),(0,q.jsx)(f.Th,{children:o(`common.label.time`)})]})}),(0,q.jsx)(f.Tbody,{children:_&&l&&_.map(e=>{let t=l.get(e.id);return(0,q.jsxs)(f.Tr,{ff:`monospace`,children:[(0,q.jsx)(f.Td,{children:(0,q.jsx)(H,{text:t?.title??``})}),(0,q.jsx)(f.Td,{children:e.score}),(0,q.jsx)(f.Td,{children:(0,xe.default)(e.time).locale(s).format(`SL HH:mm`)})]},e.id)})})]})}):(0,q.jsx)(S,{py:`1rem`,fw:`bold`,children:o(`game.placeholder.no_solved`)})]})})});var Ce=50,we=70,Te=K.memo(({item:e,onOpenDetail:t})=>{let n=C(),r=e.solvedChallenges,i=(0,K.useMemo)(()=>r?.reduce((e,t)=>e+(t?.score??0),0)??0,[r]);return(0,q.jsxs)(f.Tr,{children:[(0,q.jsx)(f.Td,{className:N(Y.mono,Y.left),children:e.rank||`-`}),(0,q.jsx)(f.Td,{className:N(Y.left,Y.teamCell),children:(0,q.jsxs)(B,{justify:`left`,gap:5,wrap:`nowrap`,style:{minWidth:0,flex:1},children:[(0,q.jsx)(M,{alt:`avatar`,src:e.avatar,radius:`xl`,size:30,color:n.primaryColor,className:u.cPointer,children:e.name?.slice(0,1)??`T`}),(0,q.jsx)(H,{text:e.name||``,size:`sm`,onClick:t,style:{width:`100%`,minWidth:0}})]})}),(0,q.jsx)(f.Td,{className:N(Y.mono,Y.left),children:i})]})}),Ee=10;const De=({divisionId:e,setDivisionId:t})=>{let{id:n}=F(),a=parseInt(n??`-1`),[o,c]=(0,K.useState)(1),[l,u]=(0,K.useState)(R.default),{scoreboard:d}=s(a),p=(0,K.useMemo)(()=>(d?.divisions??[]).filter(e=>e.id!==void 0&&e.id!==null).map(e=>({value:e.id.toString(),label:e.name?.trim()||`#${e.id}`})),[d?.divisions]),m=(0,K.useMemo)(()=>e===null?`all`:e.toString(),[e]);(0,K.useEffect)(()=>{e!==null&&!p.some(t=>Number(t.value)===e)&&t(null)},[p,e,t]);let h=(0,K.useMemo)(()=>e===null?d?.items:d?.items?.filter(t=>(t.divisionId??null)===e),[d,e]),g=(o-1)*Ee,_=h?.slice(g,g+Ee),[y,b]=(0,K.useState)(null),[x,S]=(0,K.useState)(!1),{t:C}=I();(0,K.useEffect)(()=>{d&&u(new R(d.bloodBonus))},[d]);let w=(0,K.useMemo)(()=>{let e=new Map;return d?.divisions?.forEach(t=>{e.set(t.id,t.name.trim())}),e},[d?.divisions]),T=v(l);return(0,q.jsxs)(te,{shadow:`xs`,p:`sm`,children:[(0,q.jsxs)(z,{gap:`xs`,children:[p.length>0&&(0,q.jsx)(i,{defaultValue:`all`,data:[{value:`all`,label:C(`game.label.score_table.all_teams`)},...p],value:m,onChange:e=>{if(!e||e===`all`)t(null);else{let n=Number(e);t(Number.isNaN(n)?null:n)}c(1)}}),(0,q.jsx)(j,{pos:`relative`,maw:`100%`,style:{overflow:`scroll`,"&::-webkit-scrollbar":{display:`none`}},children:(0,q.jsxs)(f,{className:Y.table,children:[(0,q.jsxs)(`colgroup`,{children:[(0,q.jsx)(`col`,{style:{width:Ce}}),(0,q.jsx)(`col`,{}),(0,q.jsx)(`col`,{style:{width:we}})]}),(0,q.jsx)(f.Thead,{className:Y.thead,children:(0,q.jsxs)(f.Tr,{children:[(0,q.jsx)(f.Th,{className:N(Y.left,Y.theadHeader),children:C(`game.label.score_table.rank_total`)}),(0,q.jsx)(f.Th,{className:N(Y.left,Y.theadHeader),children:C(`game.label.score_table.team`)}),(0,q.jsx)(f.Th,{className:N(Y.left,Y.theadHeader),children:C(`game.label.score_table.score_total`)})]})}),(0,q.jsx)(f.Tbody,{children:d&&_?.map((e,t)=>(0,q.jsx)(Te,{item:e,onOpenDetail:()=>{b(e),S(!0)}},g+t))})]})}),(0,q.jsx)(B,{justify:`center`,wrap:`nowrap`,children:(0,q.jsx)(r,{size:`sm`,value:o,onChange:c,total:Math.ceil((h?.length??1)/Ee)})})]}),(0,q.jsx)(Se,{scoreboard:d,divisionMap:w,bloodBonusMap:T,opened:x,withCloseButton:!1,size:`40rem`,onClose:()=>S(!1),item:y})]})};var Oe=()=>{let{id:e}=F(),{teamInfo:t,error:r}=c(parseInt(e??`-1`)),[i,a]=(0,K.useState)(null),o=h(1080),s=h();return(0,q.jsx)(n,{width:`90%`,minWidth:0,children:o?(0,q.jsxs)(z,{pt:`md`,children:[t&&!r&&(0,q.jsx)(le,{}),s?(0,q.jsx)(De,{divisionId:i,setDivisionId:a}):(0,q.jsx)(ye,{divisionId:i,setDivisionId:a})]}):(0,q.jsx)(ue,{children:(0,q.jsxs)(z,{pb:`2rem`,children:[(0,q.jsx)(be,{divisionId:i}),(0,q.jsx)(ye,{divisionId:i,setDivisionId:a})]})})})};export{Oe as default};