/* The GZ::CTF Project @unknown
 * 
 * License   : GNU Affero General Public License v3.0 (Core)
 * License   : LicenseRef-GZCTF-Restricted (Restricted components)
 * Commit    : Unofficial build version
 * Build     : 2025-12-08T11:45:34.456Z
 * Copyright (C) 2022-2025 GZTimeWalker. All Rights Reserved.
 */
import{l as e}from"./index.hrqptwjo.js";var t=`Data to encrypt cannot be empty`,n=`Invalid public key`,r=[`X25519`,`SHA-256`,`AES-GCM`],i=e=>new Uint8Array(e),a=e=>e?Uint8Array.from(atob(e),e=>e.charCodeAt(0)):i(0),o=e=>btoa(String.fromCharCode(...e));async function s(e,o){if(!e||e.length===0)throw Error(t);if(!o)throw Error(n);let s=a(o);if(s.length!==32)throw Error(n);let c=window.crypto.subtle,l=await c.importKey(`raw`,s,r[0],!0,[]),u=await c.generateKey(r[0],!0,[`deriveBits`]),d=i(await c.exportKey(`raw`,u.publicKey)),f=await c.deriveBits({name:r[0],public:l},u.privateKey,256),p=await c.digest(r[1],f),m=await c.importKey(`raw`,p,{name:r[2],length:256},!1,[`encrypt`]),h=crypto.getRandomValues(i(12)),g=i(await c.encrypt({name:r[2],iv:h,tagLength:128},m,e)),_=i(d.length+h.length+g.length);return _.set(d,0),_.set(h,d.length),_.set(g,d.length+h.length),_}const c=!!window.crypto?.subtle;async function l(t,n,r){if(!r)return n;if(!c){let n=t(`common.error.encryption_failed.title`),r=t(`common.error.encryption_failed.not_secure_contexts`);throw console.error(n,r),new e(n,r)}try{return o(await s(new TextEncoder().encode(n),r))}catch(n){let r=t(`common.error.encryption_failed.title`),i=t(`common.error.encryption_failed.need_upgrade`);throw console.error(r,i,n),new e(r,i)}}export{c as n,l as t};