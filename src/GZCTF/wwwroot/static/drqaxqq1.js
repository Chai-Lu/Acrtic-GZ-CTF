/* The GZ::CTF Project @unknown
 * 
 * License   : GNU Affero General Public License v3.0 (Core)
 * License   : LicenseRef-GZCTF-Restricted (Restricted components)
 * Commit    : Unofficial build version
 * Build     : 2025-12-08T11:45:34.456Z
 * Copyright (C) 2022-2025 GZTimeWalker. All Rights Reserved.
 */
import"./lcut4z52.js";import"./isy1dskq.js";import{t as e}from"./x5mn38mu.js";import"./kocdnk2i.js";import"./nugqs812.js";import{t}from"./gmgm1gqp.js";import"./h0nb8b87.js";import{$n as n,Ca as r,Cr as i,Dr as a,Hr as o,In as s,Jr as c,L as l,Li as u,O as d,Oa as f,W as p,Wi as m,_i as h,di as g,dr as _,g as v,ha as y,li as b,q as x,yi as S,z as C}from"./index.hrqptwjo.js";import"./iwhjrhtg.js";import"./mdazlrzp.js";import{t as w}from"./mbfygvvk.js";import{t as T}from"./c5hn22cb.js";import{n as E,r as D,t as O}from"./eogutjjz.js";import{n as k}from"./je83xcx9.js";var A=f(d(),1),j=f(a(),1),M=f(r(),1),N=f(y(),1),P=50,F=function(e){return e.Info=`Information`,e.Warn=`Warning`,e.Error=`Error`,e.All=`All`,e}(F||{}),I=()=>{let[r,a]=(0,M.useState)(F.Info),[d,f]=(0,M.useState)(1),y=u(),[,I]=(0,M.useState)(new Date),L=(0,M.useRef)([]),[R,z]=(0,M.useState)(),{t:B}=_(),{locale:V}=n(),H=(0,M.useRef)(null);(0,M.useEffect)(()=>{H.current?.scrollTo({top:0,behavior:`smooth`})},[d,r,H]),(0,M.useEffect)(()=>{(async()=>{try{z((await s.admin.adminLogs({level:r,count:P,skip:(d-1)*P})).data)}catch(e){i({color:`red`,title:B(`admin.notification.logs.fetch_failed`),message:await k(e),icon:(0,N.jsx)(A.Icon,{path:x,size:1})})}})(),d===1&&(L.current=[])},[d,r]),(0,M.useEffect)(()=>{f(1)},[r]),(0,M.useEffect)(()=>{let e=new O().withUrl(`/hub/admin`).withHubProtocol(new E).withAutomaticReconnect().configureLogging(D.None).build();return e.serverTimeoutInMilliseconds=60*1e3*60*24,e.on(`ReceivedLog`,e=>{console.log(e),L.current=[e,...L.current],I(new Date(e.time))}),(async()=>{try{await e.start(),i({color:`teal`,message:B(`admin.notification.logs.connected`),icon:(0,N.jsx)(A.Icon,{path:p,size:1})})}catch(e){console.error(e)}})(),()=>{e.stop().catch(e=>{console.error(e)})}},[]);let U=[...d===1?L.current:[],...R??[]].filter(e=>r===`All`||e.level===r).map((e,n)=>(0,N.jsxs)(t.Tr,{className:m({[T.fade]:n===0&&d===1&&L.current.length>0&&L.current[0].level===r}),children:[(0,N.jsx)(t.Td,{className:T.time,children:(0,N.jsx)(o,{size:`sm`,color:`indigo`,fullWidth:!0,children:(0,j.default)(e.time).locale(V).format(`SL HH:mm:ss`)})}),(0,N.jsx)(t.Td,{children:(0,N.jsx)(c,{ff:`monospace`,size:`sm`,fw:500,className:T.overflow,children:e.ip||``})}),(0,N.jsx)(t.Td,{children:(0,N.jsx)(c,{ff:`monospace`,size:`sm`,fw:`bold`,className:T.overflow,children:e.name||``})}),(0,N.jsx)(t.Td,{children:(0,N.jsx)(c,{size:`sm`,className:T.overflow,children:e.msg||``})}),(0,N.jsx)(t.Td,{ff:`monospace`,children:e.status&&(0,N.jsx)(o,{size:`sm`,color:v.get(e.status)??`gray`,children:e.status})})]},`${e.time}@${n}`));return(0,N.jsx)(w,{isLoading:!R,head:(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(e,{color:y.primaryColor,value:r,bg:`transparent`,onChange:e=>a(e),data:Object.entries(F).map(e=>({value:e[1],label:e[0]}))}),(0,N.jsxs)(b,{justify:`right`,children:[(0,N.jsx)(g,{size:`lg`,disabled:d<=1,onClick:()=>f(d-1),children:(0,N.jsx)(A.Icon,{path:l,size:1})}),(0,N.jsx)(c,{fw:`bold`,size:`sm`,children:d}),(0,N.jsx)(g,{size:`lg`,disabled:R&&R.length<P,onClick:()=>f(d+1),children:(0,N.jsx)(A.Icon,{path:C,size:1})})]})]}),children:(0,N.jsx)(h,{shadow:`md`,p:`md`,w:`100%`,children:(0,N.jsx)(S,{viewportRef:H,offsetScrollbars:!0,scrollbarSize:4,h:`calc(100vh - 190px)`,children:(0,N.jsxs)(t,{className:m(T.table,T.fixed),children:[(0,N.jsx)(t.Thead,{children:(0,N.jsxs)(t.Tr,{children:[(0,N.jsx)(t.Th,{w:`7rem`,children:B(`common.label.time`)}),(0,N.jsx)(t.Th,{w:`9rem`,children:B(`common.label.ip`)}),(0,N.jsx)(t.Th,{w:`7rem`,children:B(`common.label.user`)}),(0,N.jsx)(t.Th,{w:`100%`,children:B(`admin.label.logs.message`)}),(0,N.jsx)(t.Th,{w:`6rem`,children:B(`admin.label.logs.status`)})]})}),(0,N.jsx)(t.Tbody,{children:U})]})})})})};export{I as default};