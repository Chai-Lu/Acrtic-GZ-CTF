/* The GZ::CTF Project @unknown
 * 
 * License   : GNU Affero General Public License v3.0 (Core)
 * License   : LicenseRef-GZCTF-Restricted (Restricted components)
 * Commit    : Unofficial build version
 * Build     : 2025-12-08T11:45:34.456Z
 * Copyright (C) 2022-2025 GZTimeWalker. All Rights Reserved.
 */
import"./lcut4z52.js";import"./cbxtepre.js";import{c as e,r as t}from"./isy1dskq.js";import"./kocdnk2i.js";import{t as n}from"./lquea752.js";import{t as r}from"./kpl3u1sg.js";import{r as i,t as a}from"./nugqs812.js";import{t as o}from"./bfzgeflf.js";import{t as s}from"./o417b45d.js";import{t as c}from"./h0nb8b87.js";import{$r as l,Ar as u,Ca as d,Fi as f,In as p,Jr as m,Li as h,Mr as g,Nn as _,O as v,Oa as y,Or as b,Pn as x,Qi as S,Rr as C,Vr as w,W as T,X as E,Xi as D,Zr as O,_ as k,b as A,di as j,dr as M,ha as N,ji as P,jn as F,jr as I,li as L,p as R,sn as z,tr as B,ui as V,wi as H}from"./index.hrqptwjo.js";import"./iwhjrhtg.js";import{n as U}from"./o7hpfmlv.js";import"./mdazlrzp.js";import{t as ee}from"./mbfygvvk.js";import{t as W}from"./bok6ip78.js";var G=y(N(),1),K=y(d(),1),q={valueComponent:({value:e})=>(0,G.jsx)(`div`,{style:{overflow:`hidden`,textOverflow:`ellipsis`,whiteSpace:`nowrap`},children:Array.isArray(e)?e.map(e=>e.name).join(`, `):e?.name})},J=H((e,t)=>{let r=P(`FileInput`,q,e),{unstyled:i,vars:a,onChange:o,value:s,defaultValue:c,multiple:u,accept:d,name:p,form:m,valueComponent:h,clearable:g,clearButtonProps:_,readOnly:v,capture:y,fileInputProps:b,rightSection:x,size:C,placeholder:w,component:T,resetRef:E,classNames:k,styles:A,attributes:j,...M}=r,N=(0,K.useRef)(null),{resolvedClassNames:F,resolvedStyles:I}=f({classNames:k,styles:A,props:r}),[L,R]=D({value:s,defaultValue:c,onChange:o,finalValue:u?[]:null}),z=Array.isArray(L)?L.length!==0:L!==null,B=x||(g&&z&&!v?(0,G.jsx)(V,{..._,variant:`subtle`,onClick:()=>R(u?[]:null),size:C,unstyled:i}):null);return(0,K.useEffect)(()=>{(Array.isArray(L)&&L.length===0||L===null)&&N.current?.()},[L]),(0,G.jsx)(n,{onChange:R,multiple:u,accept:d,name:p,form:m,resetRef:S(N,E),disabled:v,capture:y,inputProps:b,children:e=>(0,G.jsx)(O,{component:T||`button`,ref:t,rightSection:B,...e,...M,__staticSelector:`FileInput`,multiline:!0,type:`button`,pointer:!0,__stylesApiProps:r,unstyled:i,size:C,classNames:k,styles:A,attributes:j,children:z?(0,G.jsx)(h,{value:L}):(0,G.jsx)(l.Placeholder,{__staticSelector:`FileInput`,classNames:F,styles:I,attributes:j,children:w})})})});J.classes=O.classes,J.displayName=`@mantine/core/FileInput`;var te=J,Y=y(v(),1),X=()=>{let{data:n,mutate:l}=p.admin.useAdminGetConfigs(F),{mutate:d}=_(),{mutate:f}=x(),[v,y]=(0,K.useState)(!1),[S,D]=(0,K.useState)(),[N,P]=(0,K.useState)(),[V,H]=(0,K.useState)(),[q,J]=(0,K.useState)(S?.customTheme),[X,Z]=(0,K.useState)(null),{t:Q}=M(),[$,ne]=(0,K.useState)(!0),re=h();(0,K.useEffect)(()=>{n&&(H(n.containerPolicy),D(n.globalConfig),P(n.accountPolicy),J(n.globalConfig?.customTheme))},[n]);let ie=async e=>{y(!0);try{await p.admin.adminUpdateConfigs(e),X&&await p.admin.adminUpdateLogo({file:X}),l({...e}),f({...e.globalConfig,...e.containerPolicy}),d()}catch(e){A(e,Q)}finally{y(!1)}},ae=async()=>{y(!0),Z(null);try{await p.admin.adminResetLogo(),l({...n,globalConfig:{...S,faviconHash:``}}),f({...n,logoUrl:``})}catch(e){A(e,Q)}finally{y(!1)}},oe=q&&/^#[0-9A-F]{6}$/i.test(q)?B(q):re.colors.brand;return(0,G.jsxs)(ee,{isLoading:!n,children:[(0,G.jsx)(w,{className:a.fixedButton,__vars:{"--fixed-right":`calc(0.05 * (100vw - 70px - 2rem) + 1rem)`},variant:`filled`,radius:`xl`,size:`md`,leftSection:(0,G.jsx)(Y.Icon,{path:$?E:T,size:1}),onClick:()=>{ie({globalConfig:{...S,customTheme:q&&/^#[0-9A-F]{6}$/i.test(q)?q:``},accountPolicy:N,containerPolicy:V}),ne(!1),setTimeout(()=>{ne(!0)},500)},disabled:!$||v,children:Q(`admin.button.save`)}),(0,G.jsxs)(I,{w:`100%`,gap:`md`,children:[(0,G.jsxs)(I,{gap:`sm`,children:[(0,G.jsx)(b,{order:2,children:Q(`admin.content.settings.platform.title`)}),(0,G.jsx)(C,{}),(0,G.jsxs)(r,{columns:4,align:`center`,children:[(0,G.jsx)(r.Col,{span:1,children:(0,G.jsx)(c,{label:Q(`admin.content.settings.platform.name.label`),description:Q(`admin.content.settings.platform.name.description`),placeholder:`GZ`,disabled:v,value:S?.title??``,onChange:e=>{D({...S,title:e.currentTarget.value})}})}),(0,G.jsx)(r.Col,{span:1,children:(0,G.jsx)(c,{label:Q(`admin.content.settings.platform.slogan.label`),description:Q(`admin.content.settings.platform.slogan.description`),placeholder:`Hack for fun not for profit`,disabled:v,value:S?.slogan??``,onChange:e=>{D({...S,slogan:e.currentTarget.value})}})}),(0,G.jsx)(r.Col,{span:1,children:(0,G.jsx)(te,{size:`sm`,label:Q(`admin.content.settings.platform.logo.label`),description:Q(`admin.content.settings.platform.logo.description`),placeholder:S?.faviconHash?Q(`admin.placeholder.settings.logo.custom`):Q(`admin.placeholder.settings.logo.default`),disabled:v,accept:R.join(`,`),value:X,onChange:Z,rightSection:(0,G.jsx)(g,{label:Q(`common.button.reset`),children:(0,G.jsx)(j,{onClick:ae,children:(0,G.jsx)(Y.Icon,{path:z,size:.85})})})})}),(0,G.jsx)(r.Col,{p:0,span:1,children:(0,G.jsx)(L,{gap:`sm`,align:`flex-end`,justify:`center`,children:[20,40,60,80].map(e=>(0,G.jsxs)(I,{align:`center`,justify:`space-between`,gap:0,children:[(0,G.jsx)(i,{size:e,url:X?URL.createObjectURL(X):void 0}),(0,G.jsxs)(m,{fw:`bold`,ta:`center`,size:`xs`,children:[e,`px`]})]},e))})}),(0,G.jsx)(r.Col,{span:2,children:(0,G.jsx)(c,{label:Q(`admin.content.settings.platform.description.label`),description:Q(`admin.content.settings.platform.description.description`),placeholder:`GZ::CTF is an open source CTF platform`,disabled:v,value:S?.description??``,onChange:e=>{D({...S,description:e.currentTarget.value})}})}),(0,G.jsx)(r.Col,{span:1,children:(0,G.jsx)(e,{size:`sm`,label:Q(`admin.content.settings.platform.color.label`),description:Q(`admin.content.settings.platform.color.description`),placeholder:Q(`common.content.color.custom.placeholder`),disabled:v,value:q??``,onChange:J})}),(0,G.jsx)(r.Col,{span:1,children:(0,G.jsx)(O,{label:Q(`admin.content.settings.platform.color_palette.label`),description:Q(`admin.content.settings.platform.color_palette.description`),h:`100%`,variant:`unstyled`,component:t,colors:oe,displayColorsInfo:!1,classNames:{input:a.flex}})}),(0,G.jsx)(r.Col,{span:3,children:(0,G.jsx)(c,{label:Q(`admin.content.settings.platform.footer.label`),description:Q(`admin.content.settings.platform.footer.description`),placeholder:Q(`admin.placeholder.settings.footer`),disabled:v,value:S?.footerInfo??``,onChange:e=>{D({...S,footerInfo:e.currentTarget.value})}})}),(0,G.jsx)(r.Col,{span:1,className:a.alignCenter,children:(0,G.jsx)(u,{checked:S?.apiEncryption??!1,disabled:v||!U,readOnly:!0,label:W(Q(`admin.content.settings.platform.api_encryption.label`),Q(`admin.content.settings.platform.api_encryption.description`),U?null:Q(`admin.content.settings.platform.api_encryption.not_available`)),onChange:e=>D({...S,apiEncryption:e.currentTarget.checked})})})]})]}),(0,G.jsxs)(I,{gap:`sm`,children:[(0,G.jsx)(b,{order:2,children:Q(`admin.content.settings.account.title`)}),(0,G.jsx)(C,{}),(0,G.jsxs)(s,{cols:4,children:[(0,G.jsx)(u,{checked:N?.allowRegister??!0,disabled:v,label:W(Q(`admin.content.settings.account.allow_register.label`),Q(`admin.content.settings.account.allow_register.description`)),onChange:e=>P({...N,allowRegister:e.currentTarget.checked})}),(0,G.jsx)(u,{checked:N?.emailConfirmationRequired??!1,disabled:v,label:W(Q(`admin.content.settings.account.email_confirmation_required.label`),Q(`admin.content.settings.account.email_confirmation_required.description`)),onChange:e=>P({...N,emailConfirmationRequired:e.currentTarget.checked})}),(0,G.jsx)(u,{checked:N?.activeOnRegister??!0,disabled:v,label:W(Q(`admin.content.settings.account.auto_active.label`),Q(`admin.content.settings.account.auto_active.description`)),onChange:e=>P({...N,activeOnRegister:e.currentTarget.checked})}),(0,G.jsx)(u,{checked:N?.useCaptcha??!1,disabled:v,label:W(Q(`admin.content.settings.account.use_captcha.label`),Q(`admin.content.settings.account.use_captcha.description`)),onChange:e=>P({...N,useCaptcha:e.currentTarget.checked})})]}),(0,G.jsx)(c,{label:Q(`admin.content.settings.account.email_domain_list.label`),description:Q(`admin.content.settings.account.email_domain_list.description`),placeholder:Q(`admin.placeholder.settings.email_domain_list`),value:N?.emailDomainList??``,onChange:e=>{P({...N,emailDomainList:e.currentTarget.value})}})]}),(0,G.jsxs)(I,{gap:`sm`,children:[(0,G.jsx)(b,{order:2,children:Q(`admin.content.settings.container.title`)}),(0,G.jsx)(C,{}),(0,G.jsxs)(s,{cols:4,className:a.alignCenter,children:[(0,G.jsx)(o,{label:Q(`admin.content.settings.container.default_lifetime.label`),description:Q(`admin.content.settings.container.default_lifetime.description`),placeholder:`120`,min:1,max:7200,disabled:v,value:V?.defaultLifetime??120,onChange:e=>{let t=k(e);isNaN(t)||H({...V,defaultLifetime:t})}}),(0,G.jsx)(o,{label:Q(`admin.content.settings.container.extension_duration.label`),description:Q(`admin.content.settings.container.extension_duration.description`),placeholder:`120`,min:1,max:7200,disabled:v,value:V?.extensionDuration??120,onChange:e=>{let t=k(e);isNaN(t)||H({...V,extensionDuration:t})}}),(0,G.jsx)(o,{label:Q(`admin.content.settings.container.renewal_window.label`),description:Q(`admin.content.settings.container.renewal_window.description`),placeholder:`10`,min:1,max:360,disabled:v,value:V?.renewalWindow??10,onChange:e=>{let t=k(e);isNaN(t)||H({...V,renewalWindow:t})}}),(0,G.jsx)(u,{checked:V?.autoDestroyOnLimitReached??!0,disabled:v,label:W(Q(`admin.content.settings.container.auto_destroy.label`),Q(`admin.content.settings.container.auto_destroy.description`)),onChange:e=>H({...V,autoDestroyOnLimitReached:e.currentTarget.checked})})]})]})]})]})};export{X as default};