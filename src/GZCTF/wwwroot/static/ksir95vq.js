/* The GZ::CTF Project @unknown
 * 
 * License   : GNU Affero General Public License v3.0 (Core)
 * License   : LicenseRef-GZCTF-Restricted (Restricted components)
 * Commit    : Unofficial build version
 * Build     : 2025-12-08T11:45:34.456Z
 * Copyright (C) 2022-2025 GZTimeWalker. All Rights Reserved.
 */
import{r as e}from"./lcut4z52.js";import"./cbxtepre.js";import{t}from"./kocdnk2i.js";import{t as n}from"./nu4jnu0f.js";import{t as r}from"./kpl3u1sg.js";import{t as i}from"./nugqs812.js";import{t as a}from"./gjb4rijj.js";import{t as o}from"./h0nb8b87.js";import{Ca as s,Cr as c,In as l,O as u,Oa as d,Pn as f,Vr as p,W as m,ar as h,dr as g,ha as _,lr as v,q as y,qr as b,sr as x,wr as S,x as C}from"./index.hrqptwjo.js";import{t as w}from"./lpdh7ltc.js";import{n as T,t as E}from"./k91mi8w4.js";import{t as D}from"./o7hpfmlv.js";var O=d(u(),1),k=d(s(),1),A=d(_(),1),j=()=>{let s=v()[0],u=x(),[d,_]=n(``),[j,M]=n(``),[N,P]=(0,k.useState)(!1),[F,I]=(0,k.useState)(!1),{captchaRef:L,getToken:R,cleanUp:z}=T(),{user:B,mutate:V}=e(),{config:H}=f(),{t:U}=g();t(U(`account.title.login`)),(0,k.useEffect)(()=>{F&&B&&(I(!1),setTimeout(()=>{u(s.get(`from`)??`/`)},200))},[B,F]);let W=async e=>{if(e.preventDefault(),j.length===0||d.length<6){c({color:`red`,title:U(`account.notification.login.invalid`),message:U(`common.error.check_input`),icon:(0,A.jsx)(O.Icon,{path:y,size:1})}),P(!1);return}let{valid:t,token:n}=await R();if(!t){c({color:`orange`,title:U(`account.notification.captcha.not_valid`),message:U(`common.error.try_later`),loading:!0});return}P(!0),c({color:`orange`,id:`login-status`,title:U(`account.notification.captcha.request_sent.title`),message:U(`account.notification.captcha.request_sent.message`),loading:!0,autoClose:!1});try{await l.account.accountLogIn({userName:j,password:await D(U,d,H.apiPublicKey),challenge:n}),S({id:`login-status`,color:`teal`,title:U(`account.notification.login.success.title`),message:U(`account.notification.login.success.message`),icon:(0,A.jsx)(O.Icon,{path:m,size:1}),autoClose:!0,loading:!1}),z(!0),I(!0),V()}catch(e){let{title:t,message:n}=C(e,U);S({id:`login-status`,color:`red`,title:t,message:n,icon:(0,A.jsx)(O.Icon,{path:y,size:1}),autoClose:!0,loading:!1}),z(!1)}finally{P(!1)}};return(0,A.jsxs)(w,{onSubmit:W,children:[(0,A.jsx)(o,{required:!0,label:U(`account.label.username_or_email`),placeholder:`ctfer`,type:`text`,w:`100%`,value:j,disabled:N,onChange:e=>M(e.currentTarget.value)}),(0,A.jsx)(a,{required:!0,label:U(`account.label.password`),id:`your-password`,placeholder:`P4ssW@rd`,w:`100%`,value:d,disabled:N,onChange:e=>_(e.currentTarget.value)}),(0,A.jsx)(E,{action:`login`,ref:L}),(0,A.jsx)(b,{fz:`xs`,className:i.alignSelfEnd,component:h,to:`/account/recovery`,children:U(`account.anchor.recovery`)}),(0,A.jsxs)(r,{grow:!0,w:`100%`,children:[(0,A.jsx)(r.Col,{span:2,children:(0,A.jsx)(p,{fullWidth:!0,variant:`outline`,component:h,to:`/account/register`,children:U(`account.button.register`)})}),(0,A.jsx)(r.Col,{span:2,children:(0,A.jsx)(p,{fullWidth:!0,disabled:N,onClick:W,children:U(`account.button.login`)})})]})]})};export{j as default};