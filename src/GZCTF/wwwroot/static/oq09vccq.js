/* The GZ::CTF Project @unknown
 * 
 * License   : GNU Affero General Public License v3.0 (Core)
 * License   : LicenseRef-GZCTF-Restricted (Restricted components)
 * Commit    : Unofficial build version
 * Build     : 2025-12-08T11:45:34.456Z
 * Copyright (C) 2022-2025 GZTimeWalker. All Rights Reserved.
 */
import"./lcut4z52.js";import"./cbxtepre.js";import{t as e}from"./isy1dskq.js";import{t}from"./kocdnk2i.js";import{t as n}from"./f25gev77.js";import{a as r,d as i,i as a,n as o,t as s}from"./gaobt2im.js";import"./j0saofxo.js";import"./nugqs812.js";import{t as c}from"./o417b45d.js";import"./h0nb8b87.js";import{$n as l,Ca as u,Dr as d,Hr as f,In as p,Jr as m,Li as h,Mi as g,Oa as _,Or as v,Ti as y,Wi as b,ar as x,dr as S,ha as C,jr as w,li as T,vi as E,yi as D}from"./index.hrqptwjo.js";var O=_(d()),k=_(u()),A={view:`T`,dataPos:`U`,dataRow:`V`,dataRect:`W`,dataItem:`X`,dataText:`Y`,dataLink:`Z`,datePos:`__`,days:`-_`,months:`a_`,date:`b_`,day:`c_`,today:`d_`,nowPoint:`e_`,month:`f_`,center:`g_`,left:`h_`,label:`i_`,nowPos:`j_`,nowBox:`k_`,fadeBox:`l_`,titlePos:`m_`,titleBox:`n_`,titleHeader:`o_`,titleRow:`p_`,title:`q_`,background:`r_`,weekends:`s_`,weekend:`t_`,gameBox:`u_`},j=_(C()),M=(e,t,n)=>(0,j.jsx)(y,{left:e*40,className:b(A.date,n),children:(0,j.jsx)(`div`,{className:A.left,children:(0,j.jsx)(m,{className:A.label,span:!0,children:t})})},e),N=(e,t,n)=>(0,j.jsx)(y,{left:e*40,className:b(A.date,n),children:(0,j.jsx)(`div`,{className:A.center,children:(0,j.jsx)(m,{className:A.label,span:!0,children:t})})},e),P=(e,t)=>(0,j.jsx)(y,{left:e*40,className:b(A.date,A.day),children:(0,j.jsx)(`div`,{className:b(A.center,A.today),children:(0,j.jsx)(m,{className:A.label,span:!0,children:t})})},e),F=280*7,I=300,L=240,R=10;const z=({items:e})=>{let t=(0,k.useRef)(null),[n,r]=(0,k.useState)({x:0,y:0});(0,k.useEffect)(()=>{t.current&&t.current.scrollTo({left:t.current.scrollWidth/3})},[t.current]);let{t:i}=S(),{locale:a}=l(),o=(0,k.useMemo)(()=>{let e=(0,O.default)().startOf(`h`),t=e.startOf(`w`).subtract(3,`w`),n=t.add(7,`w`).subtract(1,`s`),r=n.diff(t,`d`),i=n.diff(t,`s`),o=[],s=[],c=[],l=[];l.push({position:0,time:t});for(let n=0;n<=r;n++){let r=t.add(n,`d`).locale(a);r.isSame(e,`d`)?s.push(P(n,r.format(`DD`))):s.push(N(n,r.format(`DD`),A.day)),r.date()===1&&(c.push(M(n,r.format(`MMMM`),A.month)),l.push({position:n*40,time:r})),r.day()===6&&o.push((0,j.jsx)(y,{left:n*40,className:A.weekend},n))}return l.reverse(),{start:t,now:e,end:n,total:r,duration:i,weekends:o,days:s,months:c,monthMap:l}},[a]),[s,c]=(0,k.useState)((0,O.default)().locale(a).format(`SMY`));(0,k.useEffect)(()=>{let e=o.monthMap;for(let t=0;t<e.length;t++)if(n.x>e[t].position){let n=e[t].time.locale(a).format(`SMY`);if(n===s)return;c(n);break}},[n,a,o.monthMap]);let u=o.now.diff(o.start,`s`)/o.duration*F+L,d=n.x+R;return(0,j.jsx)(D,{h:I,scrollbars:`x`,viewportRef:t,onScrollPositionChange:r,children:(0,j.jsxs)(y,{className:A.view,__vars:{"--sticky-width":`${L}px`,"--view-width":`${F}px`,"--view-height":`${I}px`,"--now-offset":`${u}px`,"--edge-padding":`${R}px`},children:[(0,j.jsx)(`div`,{className:A.background,children:(0,j.jsx)(`div`,{className:A.weekends,children:o.weekends})}),(0,j.jsx)(`div`,{className:A.dataPos,children:e.map(e=>{if(e.end.isBefore(o.start)||e.start.isAfter(o.end))return(0,j.jsx)(`div`,{className:A.dataRow},e.id);let t=e.start<o.start?-10:e.start.diff(o.start,`s`)/o.duration*F,n=e.end>o.end,r=n?F:e.end.diff(o.start,`s`)/o.duration*F,i=d<t?`b`:d>r?`a`:`i`;return(0,j.jsxs)(y,{className:A.dataRow,__vars:{"--left":`${t+L}px`,"--right":`${r+L}px`,"--width":`${r-t}px`,"--color":e.color},children:[(0,j.jsx)(`div`,{className:b(A.dataItem,A.dataRect),"data-rov":n||void 0,children:(0,j.jsx)(x,{className:A.dataLink,to:`/games/${e.id}`})}),(0,j.jsx)(`div`,{"data-state":i,className:b(A.dataText,A.dataRect),children:(0,j.jsx)(m,{children:e.textTitle})})]},e.id)})}),(0,j.jsxs)(`div`,{className:A.datePos,children:[(0,j.jsx)(`div`,{className:A.months,children:o.months}),(0,j.jsx)(`div`,{className:A.days,children:o.days}),(0,j.jsx)(`div`,{className:A.nowPoint})]}),(0,j.jsx)(`div`,{className:A.nowPos,children:(0,j.jsxs)(`div`,{className:A.nowBox,children:[(0,j.jsx)(m,{size:`sm`,fw:500,children:s}),(0,j.jsx)(`div`,{className:A.fadeBox})]})}),(0,j.jsx)(`div`,{className:A.titlePos,children:(0,j.jsxs)(`div`,{className:A.titleBox,children:[(0,j.jsx)(`div`,{className:A.titleHeader,children:(0,j.jsxs)(w,{justify:`center`,gap:4,align:`center`,h:`100%`,children:[(0,j.jsx)(v,{order:3,size:`xl`,children:i(`common.content.home.recent_games`)}),(0,j.jsxs)(m,{size:`sm`,fw:500,children:[(0,j.jsx)(`span`,{children:o.start.locale(a).format(`SLL`)}),(0,j.jsx)(`span`,{children:` - `}),(0,j.jsx)(`span`,{children:o.end.locale(a).format(`SLL`)})]})]})}),e.map(e=>(0,j.jsx)(`div`,{className:A.titleRow,children:e.title},e.id))]})})]})})};var B=12,V=()=>{let{t:l}=S(),{recentGames:u}=i(),[d,_]=(0,k.useState)(1),{data:v}=p.game.useGameGames({count:B,skip:(d-1)*B},{refreshInterval:300*1e3});t(l(`game.title.index`));let y=h(),{colorScheme:b}=g(),C=u?.map(e=>{let{startTime:t,endTime:n,status:i}=a(e),s=o.get(i)??`gray`,c=y.colors[s][b===`dark`?9:4];return{id:e.id,textTitle:e.title??``,color:c,title:(0,j.jsx)(E,{w:`100%`,component:x,to:`/games/${e.id}`,children:(0,j.jsxs)(T,{gap:`sm`,className:A.gameBox,children:[(0,j.jsx)(m,{size:`sm`,className:A.title,children:e.title}),(0,j.jsx)(f,{size:`sm`,color:s,children:r(l,e.limit)})]})}),start:t,end:n}})??[],D=Math.ceil((v?.total??0)/B);return(0,j.jsxs)(e,{withFooter:!0,withHeader:!0,stickyHeader:!0,children:[(0,j.jsx)(z,{items:C}),(0,j.jsxs)(w,{pt:`md`,mih:`calc(100vh - 78px)`,justify:`space-between`,children:[(0,j.jsx)(c,{cols:{base:1,sm:1,md:2,lg:3,xl:3,w18:4,w24:5},spacing:`lg`,verticalSpacing:`lg`,children:v&&v.data.map(e=>(0,j.jsx)(s,{game:e},e.id))}),(0,j.jsx)(n.Root,{total:D,siblings:3,value:d,onChange:_,mb:`xl`,children:(0,j.jsxs)(T,{gap:5,justify:`flex-end`,children:[(0,j.jsx)(n.First,{}),(0,j.jsx)(n.Previous,{}),(0,j.jsx)(n.Items,{}),(0,j.jsx)(n.Next,{}),(0,j.jsx)(n.Last,{})]})})]})]})};export{V as default};