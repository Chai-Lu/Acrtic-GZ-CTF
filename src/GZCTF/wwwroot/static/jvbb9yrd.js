/* The GZ::CTF Project @unknown
 * 
 * License   : GNU Affero General Public License v3.0 (Core)
 * License   : LicenseRef-GZCTF-Restricted (Restricted components)
 * Commit    : Unofficial build version
 * Build     : 2025-12-08T11:45:34.456Z
 * Copyright (C) 2022-2025 GZTimeWalker. All Rights Reserved.
 */
import"./lcut4z52.js";import"./cbxtepre.js";import"./isy1dskq.js";import"./kocdnk2i.js";import{t as e}from"./nu4jnu0f.js";import{t}from"./kpl3u1sg.js";import{t as n}from"./nugqs812.js";import{t as r}from"./gmgm1gqp.js";import{t as i}from"./h0nb8b87.js";import{t as a}from"./lj7msjkh.js";import{$r as o,Br as s,Bt as c,Ca as l,Cr as u,Ft as d,Hr as f,In as p,It as m,Jr as h,L as g,Li as _,Lr as v,M as y,Mr as b,Nr as x,O as S,Oa as C,Ur as w,Vr as T,W as E,Wi as D,Zt as O,_i as k,b as A,di as j,dn as M,dr as N,ha as P,jr as F,li as I,tt as L,yi as R,z as ee,zr as z}from"./index.hrqptwjo.js";import"./iwhjrhtg.js";import{t as B}from"./cjpezv9m.js";import"./mdazlrzp.js";import{t as V}from"./mbfygvvk.js";import{t as H}from"./c5hn22cb.js";import{t as U}from"./l7haotmn.js";var W=C(S()),G=C(l()),K=C(P());const q=e=>{let{team:n,mutateTeam:r,...a}=e,o=_(),[c,l]=(0,G.useState)(!1),[d,f]=(0,G.useState)(n),[m,g]=(0,G.useState)({}),{t:y}=N();(0,G.useEffect)(()=>{g({...n}),f(n)},[n]);let b=async()=>{l(!0);try{await p.admin.adminUpdateTeam(d.id,m),u({color:`teal`,message:y(`team.notification.updated`),icon:(0,K.jsx)(W.Icon,{path:E,size:1})}),r({...d,name:m.name,bio:m.bio,locked:m.locked??d.locked}),a.onClose()}catch(e){A(e,y)}finally{l(!1)}};return(0,K.jsx)(x,{...a,children:(0,K.jsxs)(F,{gap:`md`,m:`auto`,mt:15,children:[(0,K.jsxs)(t,{grow:!0,children:[(0,K.jsx)(t.Col,{span:8,children:(0,K.jsx)(i,{label:(0,K.jsx)(I,{justify:`left`,gap:`xs`,children:(0,K.jsx)(h,{size:`sm`,children:y(`team.label.name`)})}),type:`text`,w:`100%`,value:m.name??`team`,disabled:c,onChange:e=>g({...m,name:e.target.value})})}),(0,K.jsx)(t.Col,{span:4,children:(0,K.jsx)(s,{children:(0,K.jsx)(w,{alt:`avatar`,radius:`xl`,size:70,src:d.avatar,children:d.name?.slice(0,1)??`T`})})})]}),(0,K.jsx)(v,{label:y(`team.label.bio`),value:m.bio??y(`team.placeholder.bio`),w:`100%`,disabled:c,autosize:!0,minRows:2,maxRows:4,onChange:e=>g({...m,bio:e.target.value})}),(0,K.jsxs)(I,{justify:`left`,children:[(0,K.jsx)(h,{size:`sm`,children:y(`team.label.members`)}),n.locked&&(0,K.jsx)(W.Icon,{path:`M12,17C10.89,17 10,16.1 10,15C10,13.89 10.89,13 12,13A2,2 0 0,1 14,15A2,2 0 0,1 12,17M18,20V10H6V20H18M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V10C4,8.89 4.89,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z`,size:.8,color:o.colors.yellow[6]})]}),(0,K.jsx)(R,{h:165,offsetScrollbars:!0,children:(0,K.jsx)(F,{gap:`xs`,children:d.members?.map(e=>(0,K.jsxs)(I,{justify:`space-between`,children:[(0,K.jsxs)(I,{justify:`left`,children:[(0,K.jsx)(w,{alt:`avatar`,src:e.avatar,radius:`xl`,children:e.userName?.slice(0,1)??`U`}),(0,K.jsxs)(F,{gap:0,children:[(0,K.jsx)(h,{fw:500,children:e.userName}),(0,K.jsx)(h,{size:`xs`,c:`dimmed`,children:`#${e.id?.substring(28)}`})]})]}),(0,K.jsx)(I,{justify:`right`,children:e.captain&&(0,K.jsx)(W.Icon,{path:`M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z`,size:1,color:o.colors.yellow[4]})})]},e.id))})}),(0,K.jsx)(I,{grow:!0,m:`auto`,w:`100%`,children:(0,K.jsx)(T,{fullWidth:!0,disabled:c,onClick:b,children:y(`admin.button.save`)})})]})})};var J=C(S(),1),Y=30,X=()=>{let[t,s]=(0,G.useState)(1),[l,d]=(0,G.useState)(new Date),{data:m,total:_,setData:v,updateData:x}=U(),[S,C]=e(``),[T,O]=(0,G.useState)(!1),[M,P]=(0,G.useState)(!1),[F,L]=(0,G.useState)(0),[W,X]=(0,G.useState)(!1),[Z,te]=(0,G.useState)({}),{t:Q}=N(),$=(0,G.useRef)(null);(0,G.useEffect)(()=>{$.current?.scrollTo({top:0,behavior:`smooth`})},[t,$]),(0,G.useEffect)(()=>{(async()=>{try{let e=await p.admin.adminTeams({count:Y,skip:(t-1)*Y});v(e.data),L((t-1)*Y+e.data.length)}catch(e){A(e,Q)}})()},[t,l]);let ne=async()=>{try{if(S){O(!0);let e=await p.admin.adminSearchTeams({hint:S});v(e.data),L(e.data.length)}else{let e=await p.admin.adminTeams({count:Y,skip:(t-1)*Y});v(e.data),L((t-1)*Y+e.data.length)}}catch(e){A(e,Q)}finally{O(!1)}},re=async e=>{try{if(!e.id)return;P(!0),await p.admin.adminDeleteTeam(e.id),u({message:Q(`admin.notification.teams.deleted`,{name:e.name}),color:`teal`,icon:(0,K.jsx)(J.Icon,{path:E,size:1})}),m&&x(m.filter(t=>t.id!==e.id)),L(F-1),d(new Date)}catch(e){A(e,Q)}finally{P(!1)}},ie=async e=>{try{if(!e.id)return;P(!0),await p.admin.adminUpdateTeam(e.id,{locked:!e.locked}),u({color:`teal`,message:Q(`team.notification.updated`),icon:(0,K.jsx)(J.Icon,{path:E,size:1})}),x([{...e,locked:!e.locked},...m?.filter(t=>t.id!==e.id)??[]].sort((e,t)=>e.id<t.id?-1:1)),d(new Date)}catch(e){A(e,Q)}finally{P(!1)}};return(0,K.jsx)(V,{isLoading:T||!m,head:(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(i,{w:`36%`,leftSection:(0,K.jsx)(J.Icon,{path:c,size:1}),placeholder:Q(`admin.placeholder.teams.search`),value:S,onChange:C,onKeyDown:e=>{!T&&e.key===`Enter`&&ne()},rightSection:(0,K.jsx)(J.Icon,{path:y,size:1})}),(0,K.jsxs)(I,{justify:`right`,children:[(0,K.jsx)(h,{fw:`bold`,size:`sm`,children:(0,K.jsxs)(a,{i18nKey:`admin.content.teams.stats`,values:{current:F,total:_},children:[`_`,(0,K.jsx)(z,{children:`_`}),`_`]})}),(0,K.jsx)(j,{size:`lg`,disabled:t<=1,onClick:()=>s(t-1),children:(0,K.jsx)(J.Icon,{path:g,size:1})}),(0,K.jsx)(h,{fw:`bold`,size:`sm`,children:t}),(0,K.jsx)(j,{size:`lg`,disabled:t*Y>=_,onClick:()=>s(t+1),children:(0,K.jsx)(J.Icon,{path:ee,size:1})})]})]}),children:(0,K.jsxs)(k,{shadow:`md`,p:`md`,w:`100%`,children:[(0,K.jsx)(R,{viewportRef:$,offsetScrollbars:!0,scrollbarSize:4,h:`calc(100vh - 190px)`,children:(0,K.jsxs)(r,{className:H.table,children:[(0,K.jsx)(r.Thead,{children:(0,K.jsxs)(r.Tr,{children:[(0,K.jsx)(r.Th,{w:`35vw`,miw:`400px`,children:Q(`common.label.team`)}),(0,K.jsx)(r.Th,{children:Q(`admin.label.teams.members`)}),(0,K.jsx)(r.Th,{children:Q(`admin.label.teams.bio`)}),(0,K.jsx)(r.Th,{})]})}),(0,K.jsx)(r.Tbody,{children:m&&m.map(e=>{let t=e.members?.sort((e,t)=>e.captain?t.captain?0:-1:1);return(0,K.jsxs)(r.Tr,{children:[(0,K.jsx)(r.Td,{children:(0,K.jsxs)(I,{justify:`space-between`,gap:0,wrap:`nowrap`,children:[(0,K.jsxs)(I,{justify:`left`,wrap:`nowrap`,w:`calc(100% - 7rem)`,children:[(0,K.jsx)(w,{alt:`avatar`,src:e.avatar,radius:`xl`,children:e.name?.slice(0,1)}),(0,K.jsx)(o,{variant:`unstyled`,value:e.name??`team`,readOnly:!0,classNames:{wrapper:n.teamNameWrapper,input:D(n.w100,n.fwBold,n.noUserSelect)}})]}),(0,K.jsx)(f,{size:`md`,color:e.locked?`yellow`:`gray`,children:e.locked?Q(`admin.content.teams.locked`):Q(`admin.content.teams.unlocked`)})]})}),(0,K.jsx)(r.Td,{children:(0,K.jsx)(b.Group,{openDelay:300,closeDelay:100,children:(0,K.jsxs)(w.Group,{spacing:`md`,children:[t&&t.slice(0,8).map(e=>(0,K.jsx)(b,{label:e.userName,withArrow:!0,children:(0,K.jsx)(w,{alt:`avatar`,radius:`xl`,src:e.avatar,children:e.userName?.slice(0,1)??`U`})},e.id)),t&&t.length>8&&(0,K.jsx)(b,{label:(0,K.jsx)(h,{children:t.slice(8).map(e=>e.userName).join(`,`)}),withArrow:!0,children:(0,K.jsxs)(w,{alt:`avatar`,radius:`xl`,children:[`+`,t.length-8]})})]})})}),(0,K.jsx)(r.Td,{children:(0,K.jsx)(h,{lineClamp:1,truncate:!0,size:`sm`,children:e.bio??Q(`team.placeholder.bio`)})}),(0,K.jsx)(r.Td,{align:`right`,children:(0,K.jsxs)(I,{wrap:`nowrap`,gap:`sm`,justify:`right`,children:[(0,K.jsx)(j,{color:`blue`,onClick:()=>{te(e),X(!0)},children:(0,K.jsx)(J.Icon,{path:`M14.06,9L15,9.94L5.92,19H5V18.08L14.06,9M17.66,3C17.41,3 17.15,3.1 16.96,3.29L15.13,5.12L18.88,8.87L20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18.17,3.09 17.92,3 17.66,3M14.06,6.19L3,17.25V21H6.75L17.81,9.94L14.06,6.19Z`,size:1})}),(0,K.jsx)(B,{iconPath:e.locked?`M10 13C11.1 13 12 13.89 12 15C12 16.11 11.11 17 10 17S8 16.11 8 15 8.9 13 10 13M18 1C15.24 1 13 3.24 13 6V8H4C2.9 8 2 8.9 2 10V20C2 21.1 2.9 22 4 22H16C17.1 22 18 21.1 18 20V10C18 8.9 17.1 8 16 8H15V6C15 4.34 16.34 3 18 3S21 4.34 21 6V8H23V6C23 3.24 20.76 1 18 1M16 10V20H4V10H16Z`:`M12,17C10.89,17 10,16.1 10,15C10,13.89 10.89,13 12,13A2,2 0 0,1 14,15A2,2 0 0,1 12,17M18,20V10H6V20H18M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V10C4,8.89 4.89,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z`,color:e.locked?`gray`:`yellow`,message:Q(`admin.content.teams.lock`,{name:e.name,action:e.locked?Q(`admin.button.teams.do_unlock`):Q(`admin.button.teams.do_lock`)}),disabled:M,onClick:()=>ie(e)}),(0,K.jsx)(B,{iconPath:`M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19M8,9H16V19H8V9M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z`,color:`alert`,message:Q(`admin.content.teams.delete`,{name:e.name}),disabled:M,onClick:()=>re(e)})]})})]},e.id)})})]})}),(0,K.jsx)(q,{size:`35%`,title:Q(`admin.button.teams.edit`),team:Z,opened:W,onClose:()=>X(!1),mutateTeam:e=>{x([e,...m?.filter(t=>t.id!==e.id)??[]].sort((e,t)=>e.id<t.id?-1:1))}})]})})};export{X as default};