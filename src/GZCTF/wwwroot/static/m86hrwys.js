/* The GZ::CTF Project @unknown
 * 
 * License   : GNU Affero General Public License v3.0 (Core)
 * License   : LicenseRef-GZCTF-Restricted (Restricted components)
 * Commit    : Unofficial build version
 * Build     : 2025-12-08T11:45:34.456Z
 * Copyright (C) 2022-2025 GZTimeWalker. All Rights Reserved.
 */
import"./lcut4z52.js";import"./isy1dskq.js";import"./kocdnk2i.js";import{t as e}from"./j0saofxo.js";import"./nugqs812.js";import"./b671iymd.js";import"./h0nb8b87.js";import{$n as t,Br as n,Ca as r,Cr as i,Dr as a,In as o,Jr as s,Lr as c,Nr as l,O as u,Oa as d,Or as f,Rr as p,Tr as m,Vr as h,W as g,Zt as _,b as v,cr as y,di as b,dr as x,ha as S,jn as C,jr as w,li as T,q as E,tn as D,tt as O,yi as k}from"./index.hrqptwjo.js";import{n as A}from"./c5dhfig7.js";import"./iwhjrhtg.js";import"./mdazlrzp.js";import"./mbfygvvk.js";import{t as j}from"./lvtgxs0o.js";var M=d(r()),N=d(u()),P=d(a()),F=d(S());const I=({gameNotice:n,onDelete:r,onEdit:i,...a})=>{let{locale:o}=t();return(0,F.jsx)(e,{...a,shadow:`sm`,p:`sm`,children:(0,F.jsxs)(T,{justify:`space-between`,wrap:`nowrap`,children:[(0,F.jsxs)(w,{gap:1,children:[(0,F.jsx)(A,{source:n.values.at(-1)||``}),(0,F.jsx)(s,{size:`xs`,fw:`bold`,c:`dimmed`,children:(0,P.default)(n.time).locale(o).format(`#SLL LTS`)})]}),(0,F.jsxs)(T,{justify:`right`,wrap:`nowrap`,children:[(0,F.jsx)(b,{onClick:i,children:(0,F.jsx)(N.Icon,{path:_,size:1})}),(0,F.jsx)(b,{onClick:r,color:`red`,children:(0,F.jsx)(N.Icon,{path:O,size:1})})]})]})})};var L=d(u());const R=e=>{let{id:t}=y(),n=parseInt(t??`-1`),{gameNotice:r,mutateGameNotice:a,...u}=e,[d,f]=(0,M.useState)(r?.values.at(-1)||``),[p,m]=(0,M.useState)(!1),{t:_}=x();(0,M.useEffect)(()=>{f(r?.values.at(-1)||``)},[r]);let b=async()=>{if(!d){i({color:`red`,message:_(`common.error.empty`),icon:(0,F.jsx)(L.Icon,{path:E,size:1})});return}if(d===r?.values.at(-1)){i({color:`orange`,message:_(`common.error.no_change`),icon:(0,F.jsx)(L.Icon,{path:E,size:1})});return}m(!0);try{let e=r?await o.edit.editUpdateGameNotice(n,r.id,{content:d.trim()}):await o.edit.editAddGameNotice(n,{content:d.trim()});i({color:`teal`,message:_(`admin.notification.games.notices.${r?`updated`:`created`}`),icon:(0,F.jsx)(L.Icon,{path:g,size:1})}),a(e.data),u.onClose()}catch(e){v(e,_)}finally{m(!1),f(``)}};return(0,F.jsx)(l,{...u,children:(0,F.jsxs)(w,{children:[(0,F.jsx)(s,{children:_(`admin.content.markdown_inline_support`)}),(0,F.jsx)(c,{value:d,w:`100%`,autosize:!0,minRows:5,maxRows:16,onChange:e=>f(e.currentTarget.value)}),(0,F.jsx)(T,{grow:!0,m:`auto`,w:`100%`,children:(0,F.jsx)(h,{fullWidth:!0,disabled:p,onClick:b,children:_(`common.modal.confirm`)})})]})})};var z=d(u(),1),B=()=>{let{id:e}=y(),t=parseInt(e??`-1`),{data:r,mutate:a}=o.edit.useEditGetGameNotices(t,C),[c,l]=(0,M.useState)(!1),[u,d]=(0,M.useState)(null),{t:_}=x(),b=m(),S=e=>{b.openConfirmModal({title:_(`admin.button.notices.delete`),children:(0,F.jsxs)(w,{children:[(0,F.jsxs)(s,{children:[` `,_(`admin.content.games.notices.delete`)]}),(0,F.jsx)(p,{}),(0,F.jsx)(A,{source:e.values.at(-1)||``})]}),onConfirm:()=>T(e),confirmProps:{color:`red`}})},T=async e=>{try{await o.edit.editDeleteGameNotice(t,e.id),i({color:`teal`,message:_(`admin.notification.games.notices.deleted`),icon:(0,F.jsx)(z.Icon,{path:g,size:1})}),a(r?.filter(t=>t.id!==e.id)??[])}catch(e){v(e,_)}};return(0,F.jsxs)(j,{headProps:{justify:`space-between`},contentPos:`right`,head:(0,F.jsx)(h,{leftSection:(0,F.jsx)(z.Icon,{path:D,size:1}),onClick:()=>{d(null),l(!0)},children:_(`admin.button.notices.new`)}),children:[(0,F.jsx)(k,{pos:`relative`,h:`calc(100vh - 180px)`,offsetScrollbars:!0,children:!r||r?.length===0?(0,F.jsx)(n,{h:`calc(100vh - 200px)`,children:(0,F.jsxs)(w,{gap:0,children:[(0,F.jsx)(f,{order:2,children:_(`admin.content.games.notices.empty.title`)}),(0,F.jsx)(s,{children:_(`admin.content.games.notices.empty.description`)})]})}):(0,F.jsx)(w,{gap:`lg`,align:`center`,m:`2%`,children:r.map(e=>(0,F.jsx)(I,{w:`95%`,gameNotice:e,onDelete:()=>{S(e)},onEdit:()=>{d(e),l(!0)}},e.id))})}),(0,F.jsx)(R,{size:`30%`,title:_(u?`admin.button.notices.edit`:`admin.button.notices.new`),opened:c,onClose:()=>l(!1),gameNotice:u,mutateGameNotice:e=>{a([e,...r?.filter(t=>t.id!==e.id)??[]])}})]})};export{B as default};