/* The GZ::CTF Project @unknown
 * 
 * License   : GNU Affero General Public License v3.0 (Core)
 * License   : LicenseRef-GZCTF-Restricted (Restricted components)
 * Commit    : Unofficial build version
 * Build     : 2025-12-08T11:45:34.456Z
 * Copyright (C) 2022-2025 GZTimeWalker. All Rights Reserved.
 */
import"./lcut4z52.js";import"./cbxtepre.js";import"./isy1dskq.js";import"./kocdnk2i.js";import"./gaobt2im.js";import"./j0saofxo.js";import{t as e}from"./kpl3u1sg.js";import"./nugqs812.js";import"./h0nb8b87.js";import{$n as t,$r as n,Br as r,Ca as i,Cr as a,Dr as o,Hr as s,In as c,Jr as l,Li as u,Mi as d,Mr as f,O as p,Oa as m,Or as ee,Rr as h,Tr as te,Ur as g,Vt as _,W as v,Wi as y,_i as ne,at as re,b,cr as x,di as S,dr as C,et as ie,f as w,ha as T,jr as E,kn as D,li as O,pt as k,q as ae,tt as A,vi as j,w as M,ya as N,yi as P,zn as F}from"./index.hrqptwjo.js";import"./iwhjrhtg.js";import{t as I}from"./cjpezv9m.js";import"./mdazlrzp.js";import"./je83xcx9.js";import"./fmw116au.js";import"./laaps3um.js";import"./odnwo8oc.js";import{t as oe}from"./drtvoui5.js";var L=m(p()),R=m(o()),z=m(i()),B={item:`nc`},V=m(T());const H=(0,z.forwardRef)((e,t)=>{let{onClick:n,active:r,children:i,disabled:a,className:o,...s}=e;return(0,V.jsx)(j,{ref:t,className:y(B.item,o),"data-active":r||void 0,onClick:n,"data-disabled":a||void 0,...s,children:i})}),U=e=>{let{itemComponent:t,itemComponentProps:n,emptyPlaceholder:i,items:a,selectedId:o,onSelect:s,...c}=e;return(0,V.jsx)(P,{type:`never`,...c,children:!a||a.length===0?(0,V.jsx)(r,{h:`100%`,children:i}):(0,V.jsx)(E,{gap:2,w:`100%`,children:a.map(e=>(0,V.jsx)(t,{onClick:s&&(()=>s(e.id)),active:o&&o===e.id,item:e,...n},e.id))})})};var W=N(60);const G=e=>{let{item:t,...r}=e,i=M().get(t.category),a=u(),o=t.type===F.DynamicContainer?`dyn`:`sta`,{classes:c}=D({fw:`bold`}),{t:d}=C();return(0,V.jsx)(H,{h:W,pr:5,...r,children:(0,V.jsxs)(O,{justify:`space-between`,gap:`sm`,w:`100%`,wrap:`nowrap`,children:[(0,V.jsxs)(O,{justify:`left`,gap:`xs`,wrap:`nowrap`,children:[(0,V.jsx)(L.Icon,{path:i.icon,color:a.colors[i.color??a.primaryColor][5],size:1}),(0,V.jsxs)(E,{gap:0,align:`flex-start`,children:[(0,V.jsx)(n,{variant:`unstyled`,value:t.title??`Team`,readOnly:!0,classNames:c}),(0,V.jsx)(s,{color:i.color,size:`xs`,variant:`dot`,children:o})]})]}),(0,V.jsxs)(O,{justify:`right`,gap:2,wrap:`nowrap`,w:`6rem`,children:[(0,V.jsxs)(l,{c:`dimmed`,size:`xs`,truncate:!0,children:[t.count,`\xA0`,d(`common.label.team`)]}),(0,V.jsx)(L.Icon,{path:_,size:1})]})]})})},K=e=>{let{item:t,...r}=e,{classes:i}=D({fw:`bold`}),{t:a}=C();return(0,V.jsx)(H,{h:W,pr:5,...r,children:(0,V.jsxs)(O,{justify:`space-between`,gap:`sm`,w:`100%`,wrap:`nowrap`,children:[(0,V.jsxs)(O,{justify:`left`,gap:`xs`,wrap:`nowrap`,children:[(0,V.jsx)(g,{alt:`avatar`,src:t.avatar,radius:`xl`,size:30,children:t.name?.slice(0,1)??`T`}),(0,V.jsxs)(E,{gap:0,align:`flex-start`,children:[(0,V.jsx)(n,{variant:`unstyled`,value:t.name??`Team`,readOnly:!0,classNames:i}),t.division&&(0,V.jsx)(s,{size:`xs`,variant:`outline`,children:t.division})]})]}),(0,V.jsxs)(O,{justify:`right`,gap:2,wrap:`nowrap`,w:`6rem`,children:[(0,V.jsxs)(l,{c:`dimmed`,size:`xs`,truncate:!0,children:[t.count,`\xA0`,a(`game.label.traffic`)]}),(0,V.jsx)(L.Icon,{path:_,size:1})]})]})})},se=e=>{let{item:t,onDownload:n,onDelete:r,disabled:i,t:a,locale:o,...c}=e;return(0,V.jsx)(H,{h:W,active:!1,...c,children:(0,V.jsxs)(O,{justify:`space-between`,gap:0,wrap:`nowrap`,w:`100%`,children:[(0,V.jsxs)(O,{justify:`space-between`,gap:0,wrap:`nowrap`,w:`calc(100% - 2.5rem)`,onClick:()=>n(t),children:[(0,V.jsxs)(O,{justify:`left`,gap:`sm`,wrap:`nowrap`,children:[(0,V.jsx)(L.Icon,{path:k,size:1.2}),(0,V.jsxs)(E,{gap:0,align:`flex-start`,children:[(0,V.jsx)(l,{truncate:!0,fw:500,children:t.fileName}),(0,V.jsx)(s,{size:`sm`,color:`indigo`,children:(0,R.default)(t.updateTime).locale(o).format(`SL LTS`)})]})]}),(0,V.jsx)(l,{fw:500,size:`sm`,children:w(t.size??0)})]}),(0,V.jsx)(O,{justify:`right`,gap:`sm`,wrap:`nowrap`,w:`2.5rem`,children:(0,V.jsx)(I,{iconPath:A,color:`red`,message:a(`game.content.traffic.delete_confirm`),disabled:i,onClick:()=>r(t)})})]})})};var q=m(p(),1),J=m(o(),1),Y={refreshInterval:0,shouldRetryOnError:!1,revalidateOnFocus:!1},X=()=>{let{id:n}=x(),i=parseInt(n??`-1`),[o,s]=(0,z.useState)(null),[p,m]=(0,z.useState)(null),[g,_]=(0,z.useState)(!1),y=u(),{t:T}=C(),{locale:D}=t(),{colorScheme:k}=d(),A=te(),{data:j,mutate:M}=c.game.useGameGetChallengesWithTrafficCapturing(i,Y),{data:P,mutate:F}=c.game.useGameGetChallengeTraffic(o??0,Y,!!o),{data:I,mutate:L}=c.game.useGameGetTeamTrafficAll(o??0,p??0,Y,!!o&&!!p),R=e=>{!o||!p||!e.fileName||window.open(`/api/game/captures/${o}/${p}/${e.fileName}`,`_blank`)},B=()=>{if(!o||!p){a({color:`red`,title:T(`common.error.encountered`),message:T(`game.notification.select_chal_and_part`),icon:(0,V.jsx)(q.Icon,{path:ae,size:1})});return}window.open(`/api/game/captures/${o}/${p}/all`,`_blank`)},H=async e=>{if(!(!o||!p||!e.fileName)){_(!0);try{await c.game.gameDeleteTeamTraffic(o,p,e.fileName),a({color:`teal`,message:T(`game.notification.traffic.deleted`),icon:(0,V.jsx)(q.Icon,{path:v,size:1})})}catch(e){b(e,T)}finally{F(),L(),_(!1)}}},W=async()=>{if(!(!o||!p)){_(!0);try{await c.game.gameDeleteAllTeamTraffic(o,p),a({color:`teal`,message:T(`game.notification.traffic.deleted`),icon:(0,V.jsx)(q.Icon,{path:v,size:1})})}catch(e){b(e,T)}finally{L(),F(),M(),_(!1)}}},X=I?.reduce((e,t)=>e+(t?.size??0),0)??0,ce=I?.sort((e,t)=>(0,J.default)(t.updateTime).diff((0,J.default)(e.updateTime)))??[],Z={borderRight:`${N(2)} solid ${k===`dark`?y.colors.dark[4]:y.colors.gray[4]}`},Q=`calc(100vh - 174px)`,$=N(32);return j?.sort((e,t)=>e.category?.localeCompare(t.category??``)??0),P?.sort((e,t)=>(e.teamId??0)-(t.teamId??0)),(0,V.jsx)(oe,{isLoading:!j,children:!j||j?.length===0?(0,V.jsx)(r,{h:`calc(100vh - 140px)`,children:(0,V.jsxs)(E,{gap:0,children:[(0,V.jsx)(ee,{order:2,children:T(`game.content.no_traffic.title`)}),(0,V.jsx)(l,{children:T(`game.content.no_traffic.comment`)})]})}):(0,V.jsx)(ne,{shadow:`md`,p:`md`,children:(0,V.jsxs)(e,{gutter:0,h:`calc(100vh - 142px)`,children:[(0,V.jsxs)(e.Col,{span:3,style:Z,children:[(0,V.jsx)(O,{h:$,pb:`3px`,px:`xs`,children:(0,V.jsx)(l,{size:`md`,fw:`bold`,children:T(`common.label.challenge`)})}),(0,V.jsx)(h,{size:`sm`}),(0,V.jsx)(U,{itemComponent:G,items:j,selectedId:o,onSelect:s,h:Q})]}),(0,V.jsxs)(e.Col,{span:3,style:Z,children:[(0,V.jsx)(O,{h:$,pb:`3px`,px:`xs`,children:(0,V.jsx)(l,{size:`md`,fw:`bold`,children:T(`common.label.team`)})}),(0,V.jsx)(h,{size:`sm`}),(0,V.jsx)(U,{itemComponent:K,items:P,selectedId:p,onSelect:m,h:Q})]}),(0,V.jsxs)(e.Col,{span:6,children:[(0,V.jsxs)(O,{h:$,pb:`3px`,px:`xs`,justify:`space-between`,wrap:`nowrap`,children:[(0,V.jsxs)(l,{size:`md`,fw:`bold`,children:[T(`game.label.traffic`),(0,V.jsx)(l,{span:!0,px:`md`,fw:`bold`,size:`sm`,c:`dimmed`,children:w(X??0)})]}),(0,V.jsxs)(O,{justify:`right`,gap:`sm`,wrap:`nowrap`,children:[(0,V.jsx)(f,{label:T(`game.button.delete.all_traffic`),position:`left`,children:(0,V.jsx)(S,{size:`md`,onClick:()=>A.openConfirmModal({title:T(`game.button.delete.all_traffic`),children:(0,V.jsx)(l,{size:`sm`,children:T(`game.content.traffic.deleted_all_confirm`)}),onConfirm:W,confirmProps:{color:`red`}}),children:(0,V.jsx)(q.Icon,{path:ie,size:1})})}),(0,V.jsx)(f,{label:T(`game.button.download.all_traffic`),position:`left`,children:(0,V.jsx)(S,{size:`md`,onClick:B,children:(0,V.jsx)(q.Icon,{path:re,size:1})})})]})]}),(0,V.jsx)(h,{size:`sm`}),(0,V.jsx)(U,{itemComponent:se,itemComponentProps:{onDownload:R,onDelete:H,disabled:g,t:T,locale:D},items:ce,h:Q})]})]})})})};export{X as default};