/* The GZ::CTF Project @unknown
 * 
 * License   : GNU Affero General Public License v3.0 (Core)
 * License   : LicenseRef-GZCTF-Restricted (Restricted components)
 * Commit    : Unofficial build version
 * Build     : 2025-12-08T11:45:34.456Z
 * Copyright (C) 2022-2025 GZTimeWalker. All Rights Reserved.
 */
import{$i as e,Ca as t,In as n,Jr as r,Ln as i,Mi as a,Nn as o,Oa as s,Ti as c,Wi as l,Zr as u,b as d,dr as f,ha as p,li as m}from"./index.hrqptwjo.js";var h=s(t(),1),g=s(p(),1),_=(0,h.forwardRef)(({as:e=`div`,...t},n)=>(0,g.jsx)(e,{...t,ref:n})),v=`cf-turnstile-script`,y=`onloadTurnstileCallback`,b=e=>!!document.getElementById(e),x=({render:e=`explicit`,onLoadCallbackName:t=y,scriptOptions:{nonce:n=``,defer:r=!0,async:i=!0,id:a=``,appendTo:o,onError:s,crossOrigin:c=``}={}})=>{let l=a||`cf-turnstile-script`;if(b(l))return;let u=document.createElement(`script`);u.id=l,u.src=`https://challenges.cloudflare.com/turnstile/v0/api.js?onload=${t}&render=${e}`,!document.querySelector(`script[src="${u.src}"]`)&&(u.defer=!!r,u.async=!!i,n&&(u.nonce=n),c&&(u.crossOrigin=c),s&&(u.onerror=s,delete window[t]),(o===`body`?document.body:document.getElementsByTagName(`head`)[0]).appendChild(u))},S={normal:{width:300,height:65},compact:{width:150,height:140},invisible:{width:0,height:0,overflow:`hidden`},flexible:{minWidth:300,width:`100%`,height:65},interactionOnly:{width:`fit-content`,height:`auto`,display:`flex`}};function C(e){if(e!==`invisible`&&e!==`interactionOnly`)return e}function w(e=v){let[t,n]=(0,h.useState)(!1);return(0,h.useEffect)(()=>{let t=()=>{b(e)&&n(!0)},r=new MutationObserver(t);return r.observe(document,{childList:!0,subtree:!0}),t(),()=>{r.disconnect()}},[e]),t}var T=`unloaded`,E,D=new Promise((e,t)=>{E={resolve:e,reject:t},T===`ready`&&e(void 0)}),O=(e=y)=>(T===`unloaded`&&(T=`loading`,window[e]=()=>{E.resolve(),T=`ready`,delete window[e]}),D),k=(0,h.forwardRef)((e,t)=>{let{scriptOptions:n,options:r={},siteKey:i,onWidgetLoad:a,onSuccess:o,onExpire:s,onError:c,onBeforeInteractive:l,onAfterInteractive:u,onUnsupported:d,onTimeout:f,onLoadScript:p,id:m,style:v,as:y=`div`,injectScript:b=!0,rerenderOnCallbackChange:E=!1,...D}=e,k=r.size,A=(0,h.useCallback)(()=>typeof k>`u`?{}:r.execution===`execute`?S.invisible:r.appearance===`interaction-only`?S.interactionOnly:S[k],[r.execution,k,r.appearance]),[j,M]=(0,h.useState)(A()),N=(0,h.useRef)(null),[P,F]=(0,h.useState)(!1),I=(0,h.useRef)(),L=(0,h.useRef)(!1),R=m||`cf-turnstile`,z=(0,h.useRef)({onSuccess:o,onError:c,onExpire:s,onBeforeInteractive:l,onAfterInteractive:u,onUnsupported:d,onTimeout:f});(0,h.useEffect)(()=>{E||(z.current={onSuccess:o,onError:c,onExpire:s,onBeforeInteractive:l,onAfterInteractive:u,onUnsupported:d,onTimeout:f})});let B=n?.id||`cf-turnstile-script`,V=w(B),H=n?.onLoadCallbackName||`onloadTurnstileCallback`,U=r.appearance||`always`,W=(0,h.useMemo)(()=>({sitekey:i,action:r.action,cData:r.cData,theme:r.theme||`auto`,language:r.language||`auto`,tabindex:r.tabIndex,"response-field":r.responseField,"response-field-name":r.responseFieldName,size:C(k),retry:r.retry||`auto`,"retry-interval":r.retryInterval||8e3,"refresh-expired":r.refreshExpired||`auto`,"refresh-timeout":r.refreshTimeout||`auto`,execution:r.execution||`render`,appearance:r.appearance||`always`,"feedback-enabled":r.feedbackEnabled||!0,callback:e=>{L.current=!0,E?o?.(e):z.current.onSuccess?.(e)},"error-callback":E?c:(...e)=>z.current.onError?.(...e),"expired-callback":E?s:(...e)=>z.current.onExpire?.(...e),"before-interactive-callback":E?l:(...e)=>z.current.onBeforeInteractive?.(...e),"after-interactive-callback":E?u:(...e)=>z.current.onAfterInteractive?.(...e),"unsupported-callback":E?d:(...e)=>z.current.onUnsupported?.(...e),"timeout-callback":E?f:(...e)=>z.current.onTimeout?.(...e)}),[r.action,r.appearance,r.cData,r.execution,r.language,r.refreshExpired,r.responseField,r.responseFieldName,r.retry,r.retryInterval,r.tabIndex,r.theme,r.feedbackEnabled,r.refreshTimeout,i,k,E,E?o:null,E?c:null,E?s:null,E?l:null,E?u:null,E?d:null,E?f:null]),G=(0,h.useCallback)(()=>typeof window<`u`&&!!window.turnstile,[]);return(0,h.useEffect)(function(){b&&!P&&x({onLoadCallbackName:H,scriptOptions:{...n,id:B}})},[b,P,n,B]),(0,h.useEffect)(function(){T!==`ready`&&O(H).then(()=>F(!0)).catch(console.error)},[]),(0,h.useEffect)(function(){if(!N.current||!P)return;let e=!1;return(async()=>{e||!N.current||(I.current=window.turnstile.render(N.current,W),I.current&&a?.(I.current))})(),()=>{e=!0,I.current&&(window.turnstile.remove(I.current),L.current=!1)}},[R,P,W]),(0,h.useImperativeHandle)(t,()=>{let{turnstile:e}=window;return{getResponse(){if(!e?.getResponse||!I.current||!G()){console.warn(`Turnstile has not been loaded`);return}return e.getResponse(I.current)},async getResponsePromise(e=3e4,t=100){return new Promise((n,r)=>{let i,a=async()=>{if(L.current&&window.turnstile&&I.current)try{let e=window.turnstile.getResponse(I.current);return i&&clearTimeout(i),e?n(e):r(Error(`No response received`))}catch(e){return i&&clearTimeout(i),console.warn(`Failed to get response`,e),r(Error(`Failed to get response`))}i||=setTimeout(()=>{i&&clearTimeout(i),r(Error(`Timeout`))},e),await new Promise(e=>setTimeout(e,t)),await a()};a()})},reset(){if(!e?.reset||!I.current||!G()){console.warn(`Turnstile has not been loaded`);return}r.execution===`execute`&&M(S.invisible);try{L.current=!1,e.reset(I.current)}catch(e){console.warn(`Failed to reset Turnstile widget ${I}`,e)}},remove(){if(!e?.remove||!I.current||!G()){console.warn(`Turnstile has not been loaded`);return}M(S.invisible),L.current=!1,e.remove(I.current),I.current=null},render(){if(!e?.render||!N.current||!G()||I.current){console.warn(`Turnstile has not been loaded or container not found`);return}let t=e.render(N.current,W);return I.current=t,I.current&&a?.(I.current),r.execution!==`execute`&&M(k?S[k]:{}),t},execute(){if(r.execution!==`execute`){console.warn(`Execution mode is not set to "execute"`);return}if(!e?.execute||!N.current||!I.current||!G()){console.warn(`Turnstile has not been loaded or container not found`);return}e.execute(N.current,W),M(k?S[k]:{})},isExpired(){return!e?.isExpired||!I.current||!G()?(console.warn(`Turnstile has not been loaded`),!1):e.isExpired(I.current)}}},[I,r.execution,k,W,N,G,P,a]),(0,h.useEffect)(()=>{V&&!P&&window.turnstile&&F(!0)},[P,V]),(0,h.useEffect)(()=>{M(A())},[r.execution,k,U]),(0,h.useEffect)(()=>{!V||typeof p!=`function`||p()},[V]),(0,g.jsx)(_,{ref:N,as:y,id:R,style:{...j,...v},...D})});k.displayName=`Turnstile`;var A={box:`je`,left:`ke`,rotating:`le`,l:`me`,stroke:`ne`,l1:`oe`,l2:`pe`,l3:`qe`};const j=({done:e})=>(0,g.jsx)(`svg`,{id:`pow`,xmlns:`http://www.w3.org/2000/svg`,width:`144`,height:`24`,viewBox:`0 0 144 24`,className:A.box,"data-done":e,children:(0,g.jsxs)(`g`,{fill:`none`,strokeWidth:`1.6`,children:[(0,g.jsx)(`path`,{className:A.left,"data-done":e,strokeWidth:`4`,strokeLinecap:`square`,strokeLinejoin:`bevel`,d:`M 16.943392,20.175366 2.7831628,11.99999 16.943392,3.8246236 Z`}),(0,g.jsx)(`path`,{"data-done":e,className:l(A.l,A.l1),d:`M 30,6 H 117`}),(0,g.jsx)(`path`,{"data-done":e,className:l(A.l,A.l2),d:`M 38,12 H 140`}),(0,g.jsx)(`path`,{"data-done":e,className:l(A.l,A.l3),d:`M 36,18 H 120`})]})});var M=function(){let e=async e=>{if(!self.crypto||!self.crypto.subtle)return{nonce:null,time:0,rate:0};let i=n(e.chall),o=e.diff,s=Math.floor(Math.random()*4294967295),c=s,l=Date.now();for(;;){let e=t(i,s),n=await crypto.subtle.digest(`SHA-256`,e);if(a(new Uint8Array(n))>=o)break;s++}let u=Date.now()-l,d=s-c;return{nonce:r(i,s),time:u,rate:d/u}},t=(e,t)=>{let n=new Uint8Array(e.length+4);n.set(e,0);for(let r=0;r<4;r++)n[e.length+r]=t>>24-r*8&255;return n},n=e=>{let t=new Uint8Array(e.length/2+4);for(let n=0;n<e.length;n+=2)t[n/2]=parseInt(e.slice(n,n+2),16);for(let n=e.length/2;n<e.length/2+4;n++)t[n]=Math.floor(Math.random()*256);return t},r=(e,t)=>`${i(e.slice(e.length-4))}${t.toString(16).padStart(8,`0`)}`,i=e=>Array.from(e).map(e=>e.toString(16).padStart(2,`0`)).join(``),a=e=>{let t=0;for(let n=0;n<e.length;n++)if(e[n]===0)t+=8;else{let r=128;for(let i=0;i<8&&(e[n]&r)===0;i++)t++,r>>=1;break}return t};self.onmessage=async t=>{let n=await e(t.data);self.postMessage(n)}}.toString(),N=M.substring(M.indexOf(`{`)+1,M.lastIndexOf(`}`)),P=new Blob([N],{type:`application/javascript`}),F=URL.createObjectURL(P),I={text:`Mc`,container:`Nc`,"bg-move":`Oc`};const L=()=>{let[t,r]=e({key:`pow-chall`,defaultValue:{time:0}}),{t:i}=f(),a=async()=>{try{let e=await n.info.infoPowChallenge();e.data&&r({chall:e.data,time:Date.now()})}catch(e){return d(e,i),null}},[o,s]=(0,h.useState)(null),[c,l]=(0,h.useState)(!1),[u,p]=(0,h.useState)(null),[m,g]=(0,h.useState)(!1);return(0,h.useEffect)(()=>{let e=new Worker(F);return e.onmessage=e=>{g(!1),e.data.nonce?s(e.data):l(!0)},p(e),()=>{e.terminate()}},[]),(0,h.useEffect)(()=>{u&&(t.chall&&Date.now()-t.time<240*1e3?(u.postMessage({chall:t.chall.challenge,diff:t.chall.difficulty}),g(!0)):a())},[u,t]),{chall:t.chall,error:c,mutate:a,result:m?null:o}};var R=(0,h.forwardRef)((e,t)=>{let{nonce:n,...i}=e,[a,o]=(0,h.useState)(`0e5cd7b6c765abbf`);(0,h.useEffect)(()=>{if(n)return;let e=new Uint32Array(2),t=setInterval(()=>{crypto.getRandomValues(e),o(e.reduce((e,t)=>e+t.toString(16).padStart(8,`0`),``))},76);return()=>clearInterval(t)},[n]);let s=!!n||void 0;return(0,g.jsxs)(m,{...i,ref:t,display:`flex`,wrap:`nowrap`,gap:0,justify:`space-between`,className:I.container,children:[(0,g.jsx)(j,{done:s}),(0,g.jsx)(r,{"data-done":s,className:I.text,children:n||a})]})});const z=(0,h.forwardRef)((e,t)=>{let{t:n}=f(),{chall:r,result:i,error:a,mutate:o}=L();return(0,h.useImperativeHandle)(t,()=>({getToken:async()=>r&&i?{valid:!0,token:`${r?.id}:${i.nonce}`}:{valid:!1},cleanUp:e=>{e||o()}}),[r,i]),(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(u,{...e,w:`100%`,required:!0,variant:`unstyled`,label:n(`account.label.captcha`),description:!a&&i?`${i.time/1e3}s @ ${i.rate.toFixed(2)} kH/s`:n(`account.placeholder.computing`),component:R,nonce:i?.nonce})})}),B=()=>{let e=(0,h.useRef)(null);return{captchaRef:e,getToken:async()=>await e.current?.getToken()??{valid:!1},cleanUp:t=>{e.current?.cleanUp?.(t)}}},V=(0,h.forwardRef)((e,t)=>{let{action:n,...r}=e,{info:s,error:l}=o(),{colorScheme:u}=a(),d=s?.type??i.None,f=(0,h.useRef)(null),p=(0,h.useRef)(null),m=document.getElementById(`nonce-container`)?.getAttribute(`data-nonce`)??void 0;return(0,h.useImperativeHandle)(t,()=>({getToken:async()=>{if(l||!s)return{valid:!1};if(d===i.HashPow)return f.current?.getToken()??{valid:!1};if(!s?.siteKey||d===i.None)return{valid:!0};let e=p.current?.getResponse();return{valid:!!e,token:e}},cleanUp:e=>{d===i.HashPow&&f.current?.cleanUp?.(e)}}),[l,s,d]),d===i.HashPow?(0,g.jsx)(z,{ref:f}):l||!s?.siteKey||d===i.None?(0,g.jsx)(c,{...r}):(0,g.jsx)(c,{...r,children:(0,g.jsx)(k,{ref:p,siteKey:s.siteKey,options:{theme:u,action:n},scriptOptions:{nonce:m}})})});export{B as n,V as t};